!function(t){var e={};function s(i){if(e[i])return e[i].exports;var n=e[i]={i:i,l:!1,exports:{}};return t[i].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=t,s.c=e,s.d=function(t,e,i){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)s.d(i,n,function(e){return t[e]}.bind(null,n));return i},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s(s.s=3)}([function(t,e,s){"use strict";function i(t,e=1){const s=Math.pow(10,e);return Math.round(t*s)/s}function n(t){return i(t,1)}function a(t){return i(t,2)}function r(t){return i(t,3)}function h(t,e,s,i){e||(e=","),isNaN(s)&&(s=0),i||(i="0");const n=t%1;let a=Math.floor(t).toString();const r=a.length;if(0!==s&&s>r){s-=r;const t=i||"0";for(;s--;)a=t+a}if(null!==e&&a.length>3){const t=Math.floor(a.length/3),s=a.length%3,i=a.split("");let n=-1;for(;++n<t;)i.splice(s+4*n,0,e);0===s&&i.shift(),a=i.join("")}return 0!==n&&(a+=n.toString().substr(1)),a}function o(t){if(t>=10&&t<=20)return"th";if(0===t)return"";switch(t%10){case 3:return"rd";case 2:return"nd";case 1:return"st";default:return"th"}}function l(t){return t<10?"0"+t:t.toString()}function c(t,e,s){return t+s*(e-t)}function u(t,e){return Math.floor(t+Math.random()*(e-t+1))}s.d(e,"i",(function(){return i})),s.d(e,"f",(function(){return n})),s.d(e,"g",(function(){return a})),s.d(e,"h",(function(){return r})),s.d(e,"b",(function(){return h})),s.d(e,"c",(function(){return o})),s.d(e,"a",(function(){return l})),s.d(e,"d",(function(){return c})),s.d(e,"e",(function(){return u}))},function(t,e,s){"use strict";function i(t,e,s=""){chrome.runtime.sendMessage({txt:"scrollCaptureTrackEvent",category:t,action:e,label:s})}function n(t){chrome.runtime.sendMessage({txt:"scrollCaptureTrackPage",path:t})}s.d(e,"a",(function(){return i})),s.d(e,"b",(function(){return n}))},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return transformLiterals}));let supportsTemplateLiterals=!1;try{eval("`foo`"),supportsTemplateLiterals=!0}catch(t){}function transformLiterals(t){if(!supportsTemplateLiterals){let e=t.split("`").join("").split("${"),s=[];for(let t=0;t<e.length;t++){let i=e[t];if(-1==i.indexOf("}"))i&&(i="'"+i+"'",s.push(i));else{let t=i.split("}");for(let e=0;e<t.length;e++){let i=t[e];i&&(e>0&&(i="'"+i+"'"),s.push(i))}}}t=s.join(" + ")}return t}},function(t,e,s){s(7),t.exports=s(4)},function(t,e,s){},,,function(t,e,s){"use strict";s.r(e),s.d(e,"app",(function(){return Gt})),s.d(e,"default",(function(){return Ut}));var i=s(1),n=s(0);class a{constructor(t=0,e=0){this.x=t,this.y=e}static lerp(t,e,s){return new a(Object(n.d)(t.x,e.x,s),Object(n.d)(t.y,e.y,s))}static distance(t,e=new a){return Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y))}static polar(t,e){return new a(t*Math.cos(e),t*Math.sin(e))}static getAngle(t,e=new a){return Math.atan2(t.y-e.y,t.x-e.x)}static random(){return new a(Math.random(),Math.random())}static rotate(t,e){const s=Math.cos(e)*t.x-Math.sin(e)*t.y,i=Math.sin(e)*t.x+Math.cos(e)*t.y;t.x=s,t.y=i}add(t){return new a(this.x+t.x,this.y+t.y)}get magnitude(){return a.distance(this)}abs(){return new a(Math.abs(this.x),Math.abs(this.y))}clamp(t,e,s,i){this.clampX(t,e),this.clampY(s,i)}clampX(t,e){this.x=Math.max(this.x,t),this.x=Math.min(this.x,e)}clampY(t,e){this.y=Math.max(this.y,t),this.y=Math.min(this.y,e)}copyFrom(t){this.x=t.x,this.y=t.y}clone(){return new a(this.x,this.y)}equals(t){return this.x===t.x&&this.y===t.y}divide(t){return new a(this.x/t.x,this.y/t.y)}divideScalar(t){return new a(this.x/t,this.y/t)}multiply(t){return new a(this.x*t.x,this.y*t.y)}multiplyScalar(t){return new a(this.x*t,this.y*t)}set(t,e){this.x=t,this.y=e}subtract(t){return new a(this.x-t.x,this.y-t.y)}serialize(){return{x:this.x,y:this.y}}deserialize(t){this.copyFrom(t)}math(t){return this.x=t(this.x),this.y=t(this.y),this}toString(){return"[Point x="+this.x+" y="+this.y+"]"}}class r{constructor(t=0,e=0,s=0,i=0){this._position=new a,this._size=new a,this.center=new a,this.halfSize=new a,this.x=t,this.y=e,this.width=s,this.height=i}get x(){return this.position.x}set x(t){this.position.x=t,this.center.x=this.position.x+this.halfSize.x}get y(){return this.position.y}set y(t){this.position.y=t,this.center.y=this.position.y+this.halfSize.y}get width(){return this.size.x}set width(t){this.size.x=t,this.halfSize.x=t/2,this.center.x=this.position.x+this.halfSize.x}get height(){return this.size.y}set height(t){this.size.y=t,this.halfSize.y=t/2,this.center.y=this.position.y+this.halfSize.y}contains(t){return t.x>=this.x&&t.x<=this.x+this.width&&t.y>=this.y&&t.y<=this.y+this.height}intersects(t){return t.x+t.width>this.x&&t.y+t.height>this.y&&t.x<this.x+this.width&&t.y<this.y+this.height}intersect(t){const e=this,s=Math.max(e.x,t.x),i=Math.min(e.x+e.width,t.x+t.width),n=Math.max(e.y,t.y),a=Math.min(e.y+e.height,t.y+t.height);let h;return h=i>=s&&a>=n?new r(s,n,i-s,a-n):new r,h}equals(t){return this.x===t.x&&this.y===t.y&&this.width===t.width&&this.height===t.height}clone(){return new r(this.x,this.y,this.width,this.height)}copyFrom(t){this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height}get position(){return this._position}set position(t){this._position=t,this.center.x=this.position.x+this.halfSize.x,this.center.y=this.position.y+this.halfSize.y}get size(){return this._size}set size(t){this._size=t}get area(){return this.size.x*this.size.y}toString(){return"[Rectangle x="+this.x+" y="+this.y+" width="+this.width+" height="+this.height+"]"}get widthToHeight(){return this.width/this.height}get heightToWidth(){return this.height/this.width}scaleWidth(t){return new r(this.x,this.y,t*this.widthToHeight,t)}scaleHeight(t){return new r(this.x,this.y,t,t*this.heightToWidth)}scaleToFillRect(t){const e=this.getScaleToFill(t);return this.scale(e,e)}scaleToFitRect(t){const e=this.getScaleToFitRect(t);return this.scale(e,e)}scale(t,e){return new r(this.x,this.y,this.width*t,this.height*e)}scaleToArea(t){const e=Math.sqrt(t/this.widthToHeight);return new r(0,0,t/e,e)}getScaleToFill(t){let e;return e=this.widthToHeight>t.widthToHeight?t.height/this.height:t.width/this.width,e}getScaleToFitRect(t){let e;return e=this.widthToHeight>t.widthToHeight?t.width/this.width:t.height/this.height,e}get isPortrait(){return this.width<=this.height}get isLandscape(){return this.height<=this.width}get topLeft(){return this.position}get topRight(){return new a(this.x+this.width,this.y)}get bottomRight(){return this.position.add(this.size)}get bottomLeft(){return new a(this.x,this.y+this.height)}getRandomPoint(){const t=a.random();return t.x*=this.size.x,t.y*=this.size.y,this.position.add(t)}}let h,o;function l(t,e,s,i=!1){for(s||(s=new a);t&&t!==e;)i&&console.log("localToGlobal element",t.nodeName,t.className,t.offsetTop),s.x+=t.offsetLeft,s.y+=t.offsetTop,t=t.parentNode;return s}"undefined"!=typeof navigator&&(h={android:!!navigator.userAgent.match(/Android/i),blackBerry:!!navigator.userAgent.match(/BlackBerry/i),iOS:!!navigator.userAgent.match(/iPhone|iPad|iPod/i),windows:!!navigator.userAgent.match(/IEMobile/i)},h.any=h.android||h.blackBerry||h.iOS||h.windows),"undefined"!=typeof window&&(o="ontouchend"in window);const c={mouseover:"mouseover",mouseout:"mouseout",mousedown:"mousedown",mouseup:"mouseup",mousemove:"mousemove",click:"click",transitionend:"transitionend",animationstart:"animationstart",animationiteration:"animationiteration",animationend:"animationend"};o&&(c.mouseover="touchstart",c.mouseout="touchend",c.mousedown="touchstart",c.mouseup="touchend",c.mousemove="touchmove",c.click="click");const u={OTransition:{transitionend:"otransitionend",animationstart:"oanimationstart",animationiteration:"oanimationiteration",animationend:"oanimationend"},MozTransition:{transitionend:"transitionend",animationstart:"moznimationstart",animationiteration:"moznimationiteration",animationend:"moznimationend"},WebkitTransition:{transitionend:"webkitTransitionEnd",animationstart:"webkitAnimationStart",animationiteration:"webkitAnimationIteration",animationend:"webkitAnimationEnd"}};"undefined"!=typeof window&&window.addEventListener("load",(function(){for(const t in u){const e=u[t];void 0!==document.body.style[t]&&(c.transitionend=e.transitionend,c.animationstart=e.animationstart,c.animationiteration=e.animationiteration,c.animationend=e.animationend)}}));class d extends Event{constructor(t,e,s){super(t,s),this.data=e}}class p extends d{static dispatch(t,e,s){t.dispatchEvent(new p(e,s))}}class m extends EventTarget{get value(){return this._value}set value(t){(t!==this._value||this.forceChangeEvent)&&(this._value=t,p.dispatch(this,"value",this.value))}reset(t){this.value=t}toString(){return this.debug&&console.log("Data.toString",this.value),this.value.toString()}serialize(){return this.value}deserialize(t){this.value=t}copy(t){this.value=t.value,p.dispatch(this,"value",this.value)}destroy(){return this.value=null,super.destroy()}static get CHANGE(){return"value"}}class v extends m{constructor(t,e=[]){super(),this.modifiers=e,this.length=new m,this.value=t}get value(){return super.value}set value(t){for(let e=0;e<this.modifiers.length;e++){const s=this.modifiers[e];s&&(t=s(t))}super.value=t,this.length.value=Math.max(1,this.value.toString().length)}destroy(){if(this.modifiers=[],this.validation)try{this.validation.destroy()}catch(t){}return this.validation=null,super.destroy()}}class g extends v{constructor(t=!1,e=[]){super(t,e)}get value(){return super.value}set value(t=!1){super.value=function(t=!1){return-1!==["true","1","yes","y","on"].indexOf(String(t).toLowerCase())}(t)}reset(t=!1){super.reset(t)}}class y extends v{constructor(t=NaN,e=[]){super(t,e)}get value(){return super.value}set value(t=NaN){super.value=Number(t)}reset(t=0){super.reset(t)}add(t=1){this.value+=t}subtract(t=1){this.value-=t}}class x extends m{constructor(t){super(),this.value=t,this.forceChangeEvent=!1}get value(){return this._value}set value(t){t!==this._value&&(this._deselectValue(this._value),this._selectValue(t)),super.value=t}toString(){return this.value.toString()}_deselectValue(t){t&&t.isSelected&&t.isSelected instanceof g&&(t.isSelected.value=!1)}_selectValue(t){t&&t.isSelected&&t.isSelected instanceof g&&(t.isSelected.value=!0)}}class w extends m{static get ITEM_CHANGE(){return"item-change"}constructor(){super(),this.dataItemChangeHandler=this.dataItemChangeHandler.bind(this),this.selectedItemChange=this.selectedItemChange.bind(this),this.selectedIndexChange=this.selectedIndexChange.bind(this),this.lastIndex=new y,this.length=new y,this.length.addEventListener(m.CHANGE,()=>{this.lastIndex.value=this.length.value-1}),this.length.value=arguments.length,this._value=[],this.selectedItem=new x,this.selectedItem.addEventListener(m.CHANGE,this.selectedItemChange),this.selectedIndex=new y,this.selectedIndex.addEventListener(m.CHANGE,this.selectedIndexChange),this.nextIndex=new y,this.prevIndex=new y,this.dataClass=Object,this.push.apply(this,arguments)}selectedItemChange(t){this.updateSelectedIndex(),this.setSelectedData(this.selectedItem.value)}updateSelectedIndex(){this.selectedIndex.removeEventListener(m.CHANGE,this.selectedIndexChange);const t=this.value.indexOf(this.selectedItem.value);this.selectedIndex.value=t,this.selectedIndex.addEventListener(m.CHANGE,this.selectedIndexChange)}setSelectedData(t){this.previousSelectedItem&&this.previousSelectedItem.isSelectedItem instanceof m&&(this.previousSelectedItem.isSelectedItem.value=!1),this.selectedData&&this.selectedData.copy(t),this.previousSelectedItem=t,this.previousSelectedItem&&this.previousSelectedItem.isSelectedItem instanceof m&&(this.previousSelectedItem.isSelectedItem.value=!0);const e=this.selectedIndex.value;let s=e+1;s>this.value.length-1&&(s=0),this.nextIndex.value=s,this.nextData&&this.nextData.copy(this.value[this.nextIndex.value]);let i=e-1;i<0&&(i=this.value.length-1),this.prevIndex.value=i,this.prevData&&this.prevData.copy(this.value[this.prevIndex.value])}selectedIndexChange(t){const e=this.selectedIndex.value;this.selectedItem.removeEventListener(m.CHANGE,this.selectedItemChange),this.selectedItem.value=this.value[e],this.selectedItem.addEventListener(m.CHANGE,this.selectedItemChange),this.setSelectedData(this.selectedItem.value)}clear(){return this.splice(0,this.value.length)}dataItemChangeHandler(t){const e=new d(w.ITEM_CHANGE,this.value);this.dispatchEvent(e)}item(t){return this._value[t]}get value(){return this._value}set value(t){t||(t=[]);for(let t=0;t<this._value.length;t++){const e=this._value[t];e instanceof m&&e.removeEventListener(m.CHANGE,this.dataItemChangeHandler)}const e=[0,this.value.length].concat(t);this.splice.apply(this,e);for(let t=0;t<this._value.length;t++){const e=this._value[t];e instanceof m&&e.addEventListener(m.CHANGE,this.dataItemChangeHandler)}this.length.value=this._value.length,p.dispatch(this,"value",this.value),this.dataItemChangeHandler(null),this.includes(this.selectedItem.value)?this.updateSelectedIndex():this.selectedItem.value=null}indexOf(t,e){return this._value.indexOf(t,e)}map(t){return this._value.map(t)}find(t){return this._value.find(t)}findByKey(t,e){return this.find(s=>s[t].toString()===e.toString())}filter(t){return this._value.filter(t)}pop(){const t=this._value.pop();t instanceof m&&t.removeEventListener(m.CHANGE,this.dataItemChangeHandler),this.length.value=this._value.length;const e=new d("remove",{value:[t],index:this.value.length,total:1});return this.dispatchEvent(e),t===this.selectedItem.value?this.selectedItem.value=null:this.updateSelectedIndex(),t}push(){const t=this.value.length,e=this._value.push.apply(this._value,arguments);this.length.value=e;const s=[];for(let t=0;t<arguments.length;t++)s.push(arguments[t]);for(let t=0;t<s.length;t++){const e=s[t];e instanceof m&&e.addEventListener(m.CHANGE,this.dataItemChangeHandler)}if(s.length>0){const e=new d("add",{value:s,index:t,total:arguments.length});this.dispatchEvent(e)}return e}reverse(){this._value.reverse();const t=new d("reverse",{value:this._value});this.dispatchEvent(t),this.updateSelectedIndex()}shift(){const t=this._value.shift();t instanceof m&&t.removeEventListener(m.CHANGE,this.dataItemChangeHandler),this.length.value=this._value.length;const e=new d("remove",{value:[t],index:0,total:1});return this.dispatchEvent(e),t===this.selectedItem.value?this.selectedItem.value=null:this.updateSelectedIndex(),t}swap(t,e){const s=this._value[t];this._value[t]=this._value[e],this._value[e]=s;const i=new d("sort",{value:this._value});this.dispatchEvent(i),this.updateSelectedIndex()}sort(t){this._value.sort(t);const e=new d("sort",{value:this._value});this.dispatchEvent(e),this.updateSelectedIndex()}splice(){const t=this._value.splice.apply(this._value,arguments);for(let e=0;e<t.length;e++){const s=t[e];s instanceof m&&s.removeEventListener(m.CHANGE,this.dataItemChangeHandler)}const e=[];for(let t=2;t<arguments.length;t++)e.push(arguments[t]);this.length.value=this._value.length;for(let t=0;t<e.length;t++){const s=e[t];s instanceof m&&s.addEventListener(m.CHANGE,this.dataItemChangeHandler)}const s=arguments[0];if(t.length>0){const e=new d("remove",{value:t,index:s,total:t.length});this.dispatchEvent(e)}if(e.length>0){const t=new d("add",{value:e,index:s,total:e.length});this.dispatchEvent(t)}return this.includes(this.selectedItem.value)?this.updateSelectedIndex():this.selectedItem.value=null,t}remove(t){const e=this.indexOf(t);-1!==e&&this.splice(e,1)}unshift(){const t=this._value.unshift.apply(this._value,arguments);this.length.value=t;const e=[];for(let t=0;t<arguments.length;t++)e.push(arguments[t]);for(let t=0;t<e.length;t++){const s=e[t];s instanceof m&&s.addEventListener(m.CHANGE,this.dataItemChangeHandler)}if(e.length>0){const t=new d("add",{value:e,index:0,total:arguments.length});this.dispatchEvent(t)}return this.updateSelectedIndex(),t}includes(t){return-1!==this.indexOf(t)}join(){return this._value.join.apply(this._value,arguments)}concat(){return this._value.concat.apply(this._value,arguments)}slice(){return this._value.slice.apply(this._value,arguments)}serialize(){const t=[];return this.forEach(e=>{t.push(e.serialize())}),t}deserialize(t){const e=[];t.forEach(t=>{const s=new this.dataClass;s.deserialize(t),e.push(s)}),this.value=e}toString(){return this.value.toString()}}function f(t=0){return isNaN(t)||t<=0?Promise.resolve():new Promise((function(e,s){setTimeout((function(){e()}),1e3*t)}))}class b extends v{constructor(t="",e=[]){super(t,e)}get value(){return super.value}set value(t=""){super.value=t.toString()}reset(t=""){super.reset(t)}}class _ extends EventTarget{constructor(t="Action",e="Action",s="Add an Action"){super(),this.capture=this.capture.bind(this),this.play=this.play.bind(this),this.reCapture=this.reCapture.bind(this),this.type=t,this.name=new b,this.name.addEventListener(m.CHANGE,()=>{this.name.length.value=Math.max(this.name.value.length,4)}),this.name.value=e,this.icon=new b,this.description=new b(s),this.captureDescription=new b,this.isTestable=new g,this.isCaptureable=new g,this.isCapturing=new g,this.changeCursorOnCapture=new g,this.isCapturing.addEventListener(m.CHANGE,t=>{this.changeCursorOnCapture.value&&(Gt.model.showCaptureIcon.value=t.data)}),this.isPlaying=new g,this.delay=new y(0),this.isSelectedItem=new g,this._array=[this]}get array(){return this._array}set array(t){this._array=t,this.dispatchEvent(new d("change_array",t))}clone(){}copy(t){t&&(this.delay.value=t.delay.value,this.isCaptureable.value=t.isCaptureable.value,this.isTestable.value=t.isTestable.value)}triggerDelay(){return f(this.delay.value).then(()=>this.trigger())}trigger(){return Promise.resolve()}serialize(){return{type:this.type,delay:this.delay.serialize(),name:this.name.serialize()}}deserialize(t){t&&(this.type=t.type,this.delay.deserialize(t.delay),this.name.deserialize(t.name))}capture(){this.isCapturing.value=!0}reCapture(){Object(i.a)("Action","reCapture",this.type),this.capture()}captureComplete(){this.isCapturing.value=!1,Gt.model.save()}captureAtInit(){}play(){return Object(i.a)("Action","play",this.type),this.isPlaying.value=!0,this.trigger().then(()=>{this.isPlaying.value=!1,Gt.model.save()})}}class E extends EventTarget{constructor(){super(),this.time=NaN,this.index=0,this.seconds=0,this.allFrames=0,this.animationFrame=this.animationFrame.bind(this)}static get TICK(){return"tick"}static get FPS(){return"fps"}start(){if(!this.isRunning)return this.isRunning=!0,window.requestAnimationFrame(this.animationFrame),this.fpsTimeout=setTimeout(this.dispatchFrameSeconds.bind(this),1e3),this}pause(){this.isRunning=!1,clearTimeout(this.fpsTimeout)}animationFrame(t){this.time=t,this.index++;const e=new d(E.TICK,this.time);this.dispatchEvent(e),this.isRunning&&window.requestAnimationFrame(this.animationFrame)}dispatchFrameSeconds(){this.allFrames+=this.index,this.seconds++;const t=new d(E.FPS,{frames:this.index,averageFrames:Math.round(this.allFrames/this.seconds*10)/10});this.dispatchEvent(t),this.index=0,setTimeout(this.dispatchFrameSeconds.bind(this),1e3)}}let S;function C(){return S||(S=(new E).start()),S}class M extends EventTarget{constructor(t=0,e=1,s=[],i=null,n=null,a="",r=!1){if(super(),t<0)throw new Error("Tween startTime must be greater than or equal to 0");if(e<=0)throw new Error("Tween duration must be greater than 0");this.tick=this.tick.bind(this),this._startTime=t,this._duration=e,this.name=a,this.debug=r,this.properties=s,this.updateHandler=i,this.completeHandler=n,this._tweenTime=NaN,this._time=NaN,this.forceUpdate=!1}get startTime(){return this._startTime}set startTime(t){this._startTime=t,this.dispatchEvent(new Event(M.CHANGE))}get endTime(){return this.startTime+this.duration}get duration(){return this._duration}set duration(t){this._duration=Object(n.i)(t,3),this.dispatchEvent(new Event(M.CHANGE))}start(t=0,e=null){this.clock=C(),this.stop(),e&&(this.updateHandler=e);const s=new Promise((t,e)=>{const s=e=>{this.removeEventListener(M.COMPLETE,s),t(this)};this.addEventListener(M.COMPLETE,s)});return this._tweenTime=NaN,this.time=t,this.previousTime=this.clock.time,this.clock.addEventListener(E.TICK,this.tick),s}tick(t){const e=this.clock.time;this.time+=(e-this.previousTime)/1e3,this.previousTime=e}pause(){this.clock.removeEventListener(E.TICK,this.tick)}resume(){this.previousTime=this.clock.time,this.clock.addEventListener(E.TICK,this.tick)}stop(){this.clock&&this.clock.removeEventListener(E.TICK,this.tick)}get time(){return this._time}set time(t){this._time=t;let e=t-this.startTime;if(e=Math.max(e,0),e=Math.min(e,this.duration),e!==this._tweenTime||this.forceUpdate){this._tweenTime=e,this.properties.forEach(t=>{t.calculate(e/this.duration,this.debug)});const t=new Event(M.UPDATE);this.updateHandler&&this.updateHandler(t),this.dispatchEvent(t)}if(e>=this.duration){const t=new Event(M.COMPLETE);this.completeHandler&&this.completeHandler(t),this.stop(),this.dispatchEvent(t)}}set timeFraction(t){this.time=t*this.duration}get timeFraction(){return this.time/this.duration}static get COMPLETE(){return"complete"}static get UPDATE(){return"update"}static get CHANGE(){return"change"}}class z{constructor(t,e,s,i,n,a,r=!1){this.target=t,this.name=e,this.startValue=s,this.endValue=i,this.ease=n,this.roundingFunc=a||this.noRounding,this.debug=r}calculate(t){let e=this.ease(t,this.startValue,this.endValue-this.startValue,1);e=this.roundingFunc(e),this.target[this.name]=e}noRounding(t){return t}}class T{constructor(t,e,s,i,n=100){this.p0=t||new a(0,0),this.p1=e||new a(0,0),this.p2=s||new a(1,1),this.p3=i||new a(1,1),this.samples=n,this.calculateLength()}clone(){return new T(this.p0.clone(),this.p1.clone(),this.p2.clone(),this.p3.clone(),this.samples)}calculateLength(){this.distances=[0],this.distancesX=[0],this.totalLength=0,this.totalX=0;let t=this.p0;for(let e=1;e<this.samples;e++){const s=e/(this.samples-1),i=this.getPoint(s),n=t.subtract(i);this.totalLength+=n.magnitude,this.distances[e]=this.totalLength,this.totalX-=n.x,this.distancesX[e]=this.totalX,t=i}}getPoint(t){const e=a.lerp(this.p0,this.p1,t),s=a.lerp(this.p1,this.p2,t),i=a.lerp(this.p2,this.p3,t),n=a.lerp(e,s,t),r=a.lerp(s,i,t);return a.lerp(n,r,t)}getPointOnCurve(t){const e=this.sampleAt(t,this.distances);return this.getPoint(e)}getPointAtX(t){const e=this.sampleAt(t,this.distancesX),s=this.getPoint(e);return s.x=t,s}sampleAt(t,e){let s=0;const i=e.length-1,n=t*e[i];let a,r=0,h=i;for(;r<=h;)if(s=Math.floor(r+(h-r)/2),a=e[s]-n,a<0)r=s+1;else{if(!(a>0)){h=s;break}h=s-1}if(s=h,e[s]===n)return s/i;const o=e[s];return(s+(n-o)/(e[s+1]-o))/i}}class H extends T{constructor(t=0,e=0,s=1,i=1,n=100){super(new a(0,0),new a(t,e),new a(s,i),new a(1,1),n),this.ease=this.ease.bind(this)}ease(t,e,s,i){return s*this.getPointAtX(t/i).y+e}clone(){return new H(this.p1.x,this.p1.y,this.p2.x,this.p1.y,this.samples)}}H.linear={ease:new H(0,0,1,1)},H.sine={easeInOut:new H(.37,0,.63,1),easeIn:new H(.12,0,.39,0),easeOut:new H(.61,1,.88,1)},H.quad={easeInOut:new H(.45,0,.55,1),easeIn:new H(.11,0,.5,0),easeOut:new H(.5,1,.89,1)},H.cubic={easeInOut:new H(.65,0,.35,1),easeIn:new H(.32,0,.67,0),easeOut:new H(.33,1,.68,1)},H.quart={easeInOut:new H(.76,0,.24,1),easeIn:new H(.5,0,.75,0),easeOut:new H(.25,1,.5,1)},H.quint={easeInOut:new H(.83,0,.17,1),easeIn:new H(.64,0,.78,0),easeOut:new H(.22,1,.36,1)},H.expo={easeInOut:new H(.87,0,.13,1),easeIn:new H(.7,0,.84,0),easeOut:new H(.16,1,.3,1)},H.back={easeInOut:new H(.68,-.6,.32,1.6),easeIn:new H(.36,0,.66,-.56),easeOut:new H(.34,1.56,.64,1)},H.circ={easeInOut:new H(.85,0,.15,1),easeIn:new H(.55,0,1,.45),easeOut:new H(0,.55,.45,1)};const L={};function P(t,e,s=!1){s&&console.log("getProperty path",t,"scope",e);let i=null;try{i=new Function("return "+t).bind(e)()}catch(t){}return i}function A(t,e){L[t]=e}const I=[function(t,e){let s=t.nodeName.toLowerCase(),i=L[s];if(i||(s=t.getAttribute("is"),s&&(i=L[s])),i){const e=new i(t);t.component=e}},function(t,e){t.component&&(t.component.scope=e)}];const k=[];for(let t=0;t<5;t++)k.push(document.createElement("div"));function N(t,e={},s=!1){let i;window.renderTemplate&&(t=window.renderTemplate(t,e));const n=k.shift();return k.push(n),n.innerHTML=t,n.children.length>0&&(i=n.children.item(0)),function(t,e){const s=O(t,[t]);for(let t=0;t<I.length;t++){const i=I[t];for(let t=s.length-1;t>-1;t--){i(s[t],e)}}}(i,e),i}function D(t){if(t){const e=O(t);for(let t=e.length-1;t>-1;t--){const s=e[t];if(s.component){if(s.component.destroy)try{s.component.destroy()}catch(t){}s.component=null}}if(t.innerHTML=null,t.parentNode&&t.parentNode.removeChild(t),t.component){if(t.component.destroy)try{t.component.destroy()}catch(t){}t.component=null}}}function O(t,e){if(e||(e=[]),t.children)for(let s=0;s<t.children.length;s++){const i=t.children.item(s);switch(i.nodeName){case"#text":case"#comment":case"BR":case"TEMPLATE":case"SCRIPT":break;default:e.push(i),O(i,e)}}return e}class R extends m{constructor(t={}){super(),this.changeHandler=this.changeHandler.bind(this);for(let e in t)this["_"+e]=t[e],Object.defineProperty(this,e,{get:function(){return this["_"+e]},set:function(t){this["_"+e]!=t&&(this["_"+e]=t,p.dispatch(this,e,t),this.changeHandler())},enumerable:!0,configurable:!0})}get value(){return this}changeHandler(){p.dispatch(this,"value",this)}destroy(){for(let t in this){let e=this[t];e instanceof m&&e.destroy(),this[t]=null}return super.destroy()}}class B extends R{constructor(t=0,e=0){super(),this.x=new y(t),this.x.addEventListener(m.CHANGE,this.changeHandler),this.y=new y(e),this.y.addEventListener(m.CHANGE,this.changeHandler)}destroy(){return this.x.removeEventListener(m.CHANGE,this.changeHandler),this.y.removeEventListener(m.CHANGE,this.changeHandler),super.destroy()}copy(t){t&&(this.x.copy(t.x),this.y.copy(t.y))}clone(){let t=new B;return t.copy(this),t}get point(){return new a(this.x.value,this.y.value)}serialize(){return{x:this.x.value,y:this.y.value}}deserialize(t){t&&(this.x.value=t.x,this.y.value=t.y)}}class F{constructor(){this.easeIn=this.easeIn.bind(this),this.easeOut=this.easeOut.bind(this),this.easeInOut=this.easeInOut.bind(this)}easeIn(t,e=0,s=1,i=1){}easeOut(t,e=0,s=1,i=1){}easeInOut(t,e=0,s=1,i=1){}}F.quad=new class extends F{easeIn(t,e=0,s=1,i=1){return s*(t/=i)*t+e}easeOut(t,e=0,s=1,i=1){return-s*(t/=i)*(t-2)+e}easeInOut(t,e=0,s=1,i=1){return(t/=i/2)<1?s/2*t*t+e:-s/2*(--t*(t-2)-1)+e}},F.cubic=new class extends F{easeIn(t,e=0,s=1,i=1){return s*(t/=i)*t*t+e}easeOut(t,e=0,s=1,i=1){return s*((t=t/i-1)*t*t+1)+e}easeInOut(t,e=0,s=1,i=1){return(t/=i/2)<1?s/2*t*t*t+e:s/2*((t-=2)*t*t+2)+e}},F.quart=new class extends F{easeIn(t,e=0,s=1,i=1){return s*(t/=i)*t*t*t+e}easeOut(t,e=0,s=1,i=1){return-s*((t=t/i-1)*t*t*t-1)+e}easeInOut(t,e=0,s=1,i=1){return(t/=i/2)<1?s/2*t*t*t*t+e:-s/2*((t-=2)*t*t*t-2)+e}},F.quint=new class extends F{easeIn(t,e=0,s=1,i=1){return s*(t/=i)*t*t*t*t+e}easeOut(t,e=0,s=1,i=1){return s*((t=t/i-1)*t*t*t*t+1)+e}easeInOut(t,e=0,s=1,i=1){return(t/=i/2)<1?s/2*t*t*t*t*t+e:s/2*((t-=2)*t*t*t*t+2)+e}},F.sine=new class extends F{easeIn(t,e=0,s=1,i=1){return-s*Math.cos(t/i*(Math.PI/2))+s+e}easeOut(t,e=0,s=1,i=1){return s*Math.sin(t/i*(Math.PI/2))+e}easeInOut(t,e=0,s=1,i=1){return-s/2*(Math.cos(Math.PI*t/i)-1)+e}},F.expo=new class extends F{easeIn(t,e=0,s=1,i=1){return 0===t?e:s*Math.pow(2,10*(t/i-1))+e}easeOut(t,e=0,s=1,i=1){return t===i?e+s:s*(1-Math.pow(2,-10*t/i))+e}easeInOut(t,e=0,s=1,i=1){return 0===t?e:t===i?e+s:(t/=i/2)<1?s/2*Math.pow(2,10*(t-1))+e:s/2*(2-Math.pow(2,-10*--t))+e}},F.circ=new class extends F{easeIn(t,e=0,s=1,i=1){return-s*(Math.sqrt(1-(t/=i)*t)-1)+e}easeOut(t,e=0,s=1,i=1){return s*Math.sqrt(1-(t=t/i-1)*t)+e}easeInOut(t,e=0,s=1,i=1){return(t/=i/2)<1?-s/2*(Math.sqrt(1-t*t)-1)+e:s/2*(Math.sqrt(1-(t-=2)*t)+1)+e}},F.elastic=new class extends F{easeIn(t,e=0,s=1,i=1,n,a){if(0===t)return e;if(1==(t/=i))return e+s;let r;return a||(a=.3*i),!n||n<Math.abs(s)?(n=s,r=a/4):r=a/(2*Math.PI)*Math.asin(s/n),-n*Math.pow(2,10*(t-=1))*Math.sin((t*i-r)*(2*Math.PI)/a)+e}easeOut(t,e=0,s=1,i=1,n,a){if(0===t)return e;if(1==(t/=i))return e+s;let r;return a||(a=.3*i),!n||n<Math.abs(s)?(n=s,r=a/4):r=a/(2*Math.PI)*Math.asin(s/n),n*Math.pow(2,-10*t)*Math.sin((t*i-r)*(2*Math.PI)/a)+s+e}easeInOut(t,e=0,s=1,i=1,n,a){if(0===t)return e;if(2==(t/=i/2))return e+s;let r;return a||(a=i*(.3*1.5)),!n||n<Math.abs(s)?(n=s,r=a/4):r=a/(2*Math.PI)*Math.asin(s/n),t<1?n*Math.pow(2,10*(t-=1))*Math.sin((t*i-r)*(2*Math.PI)/a)*-.5+e:n*Math.pow(2,-10*(t-=1))*Math.sin((t*i-r)*(2*Math.PI)/a)*.5+s+e}},F.back=new class extends F{constructor(t=1.70158){super(),this.s=t}easeIn(t,e=0,s=1,i=1,n){return void 0===n&&(n=this.s),s*(t/=i)*t*((n+1)*t-n)+e}easeOut(t,e=0,s=1,i=1,n){return void 0===n&&(n=this.s),s*((t=t/i-1)*t*((n+1)*t+n)+1)+e}easeInOut(t,e=0,s=1,i=1,n){return void 0===n&&(n=this.s),(t/=i/2)<1?s/2*(t*t*((1+(n*=1.525))*t-n))+e:s/2*((t-=2)*t*((1+(n*=1.525))*t+n)+2)+e}},F.bounce=new class extends F{easeOut(t,e=0,s=1,i=1){return(t/=i)<1/2.75?s*(7.5625*t*t)+e:t<2/2.75?s*(7.5625*(t-=1.5/2.75)*t+.75)+e:t<2.5/2.75?s*(7.5625*(t-=2.25/2.75)*t+.9375)+e:s*(7.5625*(t-=2.625/2.75)*t+.984375)+e}easeIn(t,e=0,s=1,i=1){return s-this.easeOut(i-t,0,s,i)+e}easeInOut(t,e=0,s=1,i=1){return t<i/2?.5*this.easeIn(2*t,0,s,i)+e:.5*this.easeOut(2*t-i,0,s,i)+.5*s+e}},F.linear=new class{constructor(){this.ease=this.ease.bind(this)}ease(t,e=0,s=1,i=1){return s*t/i+e}};class X extends R{constructor(){super(),this._value=this,this.p0=new B(0,0),this.p1=new B(0,0),this.p2=new B(1,1),this.p3=new B(1,1),this.p0.addEventListener("value",this.changeHandler),this.p1.addEventListener("value",this.changeHandler),this.p2.addEventListener("value",this.changeHandler),this.p3.addEventListener("value",this.changeHandler);for(let t=0;t<4;t++){let e=this["p"+t];e.x.modifiers=[n.g],e.y.modifiers=[n.g]}this.controlPoints=[this.p1,this.p2],this.controlPointsLines=[[this.p0,this.p1],[this.p3,this.p2]],this.easing=new H,this.debugEasing=F.quad.easeInOut,this.changeHandler()}copy(t){t&&(this.p0.copy(t.p0),this.p1.copy(t.p1),this.p2.copy(t.p2),this.p3.copy(t.p3))}changeHandler(){this.easing.p1.x=this.p1.x.value,this.easing.p1.y=this.p1.y.value,this.easing.p2.x=this.p2.x.value,this.easing.p2.y=this.p2.y.value,this.easing.calculateLength(),super.changeHandler()}}class V extends _{constructor(t,e,s=0,i=0,n=1,r=0){super("ActionTween","ActionTween"),this.startX=new y(t),this.startY=new y(e),this.endX=new y(s),this.endY=new y(i),this.duration=new y(n),this.cubicBezierPoints=new X,this.easingPresets=new w,this.easingPresets.selectedItem.addEventListener(m.CHANGE,this.easingPresetChange.bind(this)),this.easingPresets.selectedItem.debug=!0;let h=["Select a preset"];for(let t in H){let e=H[t];for(let s in e){let e=t+"."+s;h.push(e)}}this.easingPresets.value=h,this.easingPresets.selectedItem.value="quad.easeInOut",this.tweenUpdateHandler=this.tweenUpdateHandler.bind(this),this.tweenCompleteHandler=this.tweenCompleteHandler.bind(this),this.pos=new a}resetEasing(){this.easingPresets.selectedItem.value=this.easingPresets.value[0]}easingPresetChange(){let t=this.easingPresets.selectedItem.value,e=P("this."+t,F);e&&(this.cubicBezierPoints.debugEasing=e);let s=P("this."+t,H);s&&(this.cubicBezierPoints.p1.x.value=s.p1.x,this.cubicBezierPoints.p1.y.value=s.p1.y,this.cubicBezierPoints.p2.x.value=s.p2.x,this.cubicBezierPoints.p2.y.value=s.p2.y)}copy(t){super.copy(t),this.startX.value=t.startX.value,this.startY.value=t.startY.value,this.endX.value=t.endX.value,this.endY.value=t.endY.value,this.duration.value=t.duration.value,this.cubicBezierPoints.copy(t.cubicBezierPoints)}trigger(){return this.tween=new M(0,this.duration.value,[new z(this.pos,"x",this.startX.value,this.endX.value,this.cubicBezierPoints.easing.ease),new z(this.pos,"y",this.startY.value,this.endY.value,this.cubicBezierPoints.easing.ease)]),this.tween.addEventListener(M.UPDATE,this.tweenUpdateHandler),this.tween.addEventListener(M.COMPLETE,this.tweenCompleteHandler),this.tween.start()}tweenUpdateHandler(t){}tweenCompleteHandler(t){}serialize(){let t=super.serialize();return t.startX=this.startX.serialize(),t.startY=this.startY.value,t.endX=this.endX.value,t.endY=this.endY.value,t.duration=this.duration.value,t.p1=this.cubicBezierPoints.p1.serialize(),t.p2=this.cubicBezierPoints.p2.serialize(),t.easing=this.easingPresets.selectedItem.value,t}deserialize(t){t&&(super.deserialize(t),this.startX.deserialize(t.startX),this.startY.deserialize(t.startY),this.endX.deserialize(t.endX),this.endY.deserialize(t.endY),this.duration.deserialize(t.duration),this.cubicBezierPoints.p1.deserialize(t.p1),this.cubicBezierPoints.p2.deserialize(t.p2),this.easingPresets.selectedItem.value=t.easing||"quad.easeInOut")}}class Y extends V{constructor(t="window",e="px",s=0,i=0,n=1,a=0){super(0,0,0,0,n,a),this.type="ActionScroll",this.name.value="Scroll",this.description.value="Add a scroll animation",this.target=new b(t),this.unitX=new y(s),this.unitY=new y(i),this.units=new w("%","px"),this.units.selectedItem.value=e,this.isCaptureable.value=!0,this.isTestable.value=!0,this.icon.value="fas fa-scroll",this.doScroll=this.doScroll.bind(this),this.unitX.addEventListener(m.CHANGE,this.doScroll),this.unitY.addEventListener(m.CHANGE,this.doScroll)}clone(){let t=new Y;return t.copy(this),t}copy(t){this.unitX.removeEventListener(m.CHANGE,this.doScroll),this.unitY.removeEventListener(m.CHANGE,this.doScroll),super.copy(t),this.target.value=t.target.value,this.unitX.value=t.unitX.value,this.unitY.value=t.unitY.value,this.units.selectedItem.value=t.units.selectedItem.value,this.unitX.addEventListener(m.CHANGE,this.doScroll),this.unitY.addEventListener(m.CHANGE,this.doScroll)}trigger(){switch(this.target.value){case"window":this.startX.value=window.scrollX,this.startY.value=window.scrollY;break;default:let t=document.querySelector(this.target.value);this.startX.value=t.scrollLeft,this.startY.value=t.scrollTop}if("px"==this.units.selectedItem.value&&(this.endX.copy(this.unitX),this.endY.copy(this.unitY)),"%"==this.units.selectedItem.value){let t={x:0,y:0};switch(this.target.value){case"window":t.x=document.body.offsetWidth-window.innerWidth,t.y=document.body.offsetHeight-window.innerHeight;break;default:let e=document.querySelector(this.target.value);t.x=e.scrollWidth-e.clientWidth,t.y=e.scrollHeight-e.clientHeight}this.endX.value=Math.round(this.unitX.value/100*t.x),this.endY.value=Math.round(this.unitY.value/100*t.y)}return super.trigger()}doScroll(){this.pos.x=this.unitX.value,this.pos.y=this.unitY.value,this.tweenUpdateHandler()}tweenUpdateHandler(){switch(this.target.value){case"window":window.scroll(this.pos.x,this.pos.y);break;default:let t=document.querySelector(this.target.value);t.scrollLeft=this.pos.x,t.scrollTop=this.pos.y}}serialize(){let t=super.serialize();return t.target=this.target.serialize(),t.unitX=this.unitX.serialize(),t.unitY=this.unitY.serialize(),t.units=this.units.selectedItem.value,t}deserialize(t){t&&(this.unitX.removeEventListener(m.CHANGE,this.doScroll),this.unitY.removeEventListener(m.CHANGE,this.doScroll),super.deserialize(t),this.target.deserialize(t.target),this.unitX.deserialize(t.unitX),this.unitY.deserialize(t.unitY),this.units.selectedItem.value=t.units,this.unitX.addEventListener(m.CHANGE,this.doScroll),this.unitY.addEventListener(m.CHANGE,this.doScroll))}capture(){super.capture(),this.unitX.removeEventListener(m.CHANGE,this.doScroll),this.unitY.removeEventListener(m.CHANGE,this.doScroll);let t=new a,e=new a;switch(this.target.value){case"window":t.x=window.scrollX,t.y=window.scrollY,e.x=document.body.offsetWidth-window.innerWidth,e.y=document.body.offsetHeight-window.innerHeight;break;default:let s=document.querySelector(this.target.value);t.x=s.scrollLeft,t.y=s.scrollTop,e.x=s.scrollWidth-s.clientWidth,e.y=s.scrollHeight-s.clientHeight}let s=new a;switch(this.units.selectedItem.value){case"px":s.x=t.x,s.y=t.y;break;case"%":s.x=Math.round(t.x/e.x*100),s.y=Math.round(t.y/e.y*100)}isNaN(s.x)&&(s.x=0),isNaN(s.y)&&(s.y=0),this.unitX.value=s.x,this.unitY.value=s.y,setTimeout(()=>{this.unitX.addEventListener(m.CHANGE,this.doScroll),this.unitY.addEventListener(m.CHANGE,this.doScroll),this.captureComplete()},200)}captureAtInit(){super.captureAtInit(),this.capture()}}class q extends _{constructor(t="click",e=0,s=0){super("ActionMouseEvent","MouseEvent","Add a mouse event"),this.x=new y(e),this.y=new y(s),this.eventTypes=new w("click","mousedown","mouseup","mouseover","mouseout","dblclick","mousemove","mouseenter","mouseleave","contextmenu","touchstart","touchmove","touchend"),this.eventTypes.selectedItem.value=this.eventTypes.value[0],this.isTestable.value=!0,this.isCaptureable.value=!0,this.changeCursorOnCapture.value=!0,this.captureMouseEventHandler=this.captureMouseEventHandler.bind(this),this.icon.value="fas fa-hand-pointer"}clone(){let t=new q;return t.copy(this),t}copy(t){super.copy(t),this.eventTypes.selectedItem.value=t.eventTypes.selectedItem.value,this.x.value=t.x.value,this.y.value=t.y.value}trigger(){let t=new a(this.x.value-window.scrollX,this.y.value-window.scrollY),e=document.elementFromPoint(t.x,t.y),s=new MouseEvent(this.eventTypes.selectedItem.value,{bubbles:!0,cancelable:!0,view:window,clientX:t.x,clientY:t.y,pageX:t.x,pageY:t.y,x:t.x,y:t.y});return e?e.dispatchEvent(s):console.log("MouseEvent action cannot find element at pageX "+this.x.value+" and pageY "+this.y.value),Promise.resolve()}serialize(){let t=super.serialize();return t.eventType=this.eventTypes.selectedItem.value,t.x=this.x.value,t.y=this.y.value,t}deserialize(t){t&&(super.deserialize(t),this.eventTypes.selectedItem.value=t.eventType,this.x.deserialize(t.x),this.y.deserialize(t.y))}capture(){super.capture(),setTimeout(()=>{document.body.addEventListener("click",this.captureMouseEventHandler)},33)}captureMouseEventHandler(t){let e=t;o&&(e=t.touches[0]);let s=new a(e.pageX,e.pageY);this.x.value=s.x,this.y.value=s.y,document.body.removeEventListener("click",this.captureMouseEventHandler),this.captureComplete()}captureAtInit(){super.captureAtInit(),this.capture()}}class j extends _{constructor(t=""){super("ActionEval","Javascript","Add javascript code"),t||(t='/* Example */\nlet promise = new Promise(function(resolve, reject) {\n    console.log("Wait for 1 second");\n    setTimeout(function() {\n        resolve();\n    }, 1000);\n});\nreturn promise.then(function() {\n    console.log("1 second has passed");\n});\n'),this.code=new b(t),this.icon.value="fab fa-js-square",this.isTestable.value=!0}clone(){let t=new j;return t.copy(this),t}copy(t){this.code.value=t.code.value}trigger(){let t=this.code.value,e=new Function(t)();return e instanceof Promise||(e=Promise.resolve()),e}serialize(){let t=super.serialize();return t.code=encodeURIComponent(this.code.value),t}deserialize(t){t&&(super.deserialize(t),this.code.value=decodeURIComponent(t.code))}}Math.PI,Math.PI;const G=[];for(let t=0;t<256;t++)G[t]=(t<16?"0":"")+t.toString(16);"undefined"!=typeof crypto&&crypto;function U(t,e,s){return Math.max(e,Math.min(s,t))}class W{constructor(t=0,e=0,s=0,i=1){this._x=t,this._y=e,this._z=s,this._w=i}static slerp(t,e,s,i){return console.warn("THREE.Quaternion: Static .slerp() has been deprecated. Use qm.slerpQuaternions( qa, qb, t ) instead."),s.slerpQuaternions(t,e,i)}static slerpFlat(t,e,s,i,n,a,r){let h=s[i+0],o=s[i+1],l=s[i+2],c=s[i+3];const u=n[a+0],d=n[a+1],p=n[a+2],m=n[a+3];if(0===r)return t[e+0]=h,t[e+1]=o,t[e+2]=l,void(t[e+3]=c);if(1===r)return t[e+0]=u,t[e+1]=d,t[e+2]=p,void(t[e+3]=m);if(c!==m||h!==u||o!==d||l!==p){let t=1-r;const e=h*u+o*d+l*p+c*m,s=e>=0?1:-1,i=1-e*e;if(i>Number.EPSILON){const n=Math.sqrt(i),a=Math.atan2(n,e*s);t=Math.sin(t*a)/n,r=Math.sin(r*a)/n}const n=r*s;if(h=h*t+u*n,o=o*t+d*n,l=l*t+p*n,c=c*t+m*n,t===1-r){const t=1/Math.sqrt(h*h+o*o+l*l+c*c);h*=t,o*=t,l*=t,c*=t}}t[e]=h,t[e+1]=o,t[e+2]=l,t[e+3]=c}static multiplyQuaternionsFlat(t,e,s,i,n,a){const r=s[i],h=s[i+1],o=s[i+2],l=s[i+3],c=n[a],u=n[a+1],d=n[a+2],p=n[a+3];return t[e]=r*p+l*c+h*d-o*u,t[e+1]=h*p+l*u+o*c-r*d,t[e+2]=o*p+l*d+r*u-h*c,t[e+3]=l*p-r*c-h*u-o*d,t}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get w(){return this._w}set w(t){this._w=t,this._onChangeCallback()}set(t,e,s,i){return this._x=t,this._y=e,this._z=s,this._w=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this}setFromEuler(t,e){if(!t||!t.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");const s=t._x,i=t._y,n=t._z,a=t._order,r=Math.cos,h=Math.sin,o=r(s/2),l=r(i/2),c=r(n/2),u=h(s/2),d=h(i/2),p=h(n/2);switch(a){case"XYZ":this._x=u*l*c+o*d*p,this._y=o*d*c-u*l*p,this._z=o*l*p+u*d*c,this._w=o*l*c-u*d*p;break;case"YXZ":this._x=u*l*c+o*d*p,this._y=o*d*c-u*l*p,this._z=o*l*p-u*d*c,this._w=o*l*c+u*d*p;break;case"ZXY":this._x=u*l*c-o*d*p,this._y=o*d*c+u*l*p,this._z=o*l*p+u*d*c,this._w=o*l*c-u*d*p;break;case"ZYX":this._x=u*l*c-o*d*p,this._y=o*d*c+u*l*p,this._z=o*l*p-u*d*c,this._w=o*l*c+u*d*p;break;case"YZX":this._x=u*l*c+o*d*p,this._y=o*d*c+u*l*p,this._z=o*l*p-u*d*c,this._w=o*l*c-u*d*p;break;case"XZY":this._x=u*l*c-o*d*p,this._y=o*d*c-u*l*p,this._z=o*l*p+u*d*c,this._w=o*l*c+u*d*p;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+a)}return!1!==e&&this._onChangeCallback(),this}setFromAxisAngle(t,e){const s=e/2,i=Math.sin(s);return this._x=t.x*i,this._y=t.y*i,this._z=t.z*i,this._w=Math.cos(s),this._onChangeCallback(),this}setFromRotationMatrix(t){const e=t.elements,s=e[0],i=e[4],n=e[8],a=e[1],r=e[5],h=e[9],o=e[2],l=e[6],c=e[10],u=s+r+c;if(u>0){const t=.5/Math.sqrt(u+1);this._w=.25/t,this._x=(l-h)*t,this._y=(n-o)*t,this._z=(a-i)*t}else if(s>r&&s>c){const t=2*Math.sqrt(1+s-r-c);this._w=(l-h)/t,this._x=.25*t,this._y=(i+a)/t,this._z=(n+o)/t}else if(r>c){const t=2*Math.sqrt(1+r-s-c);this._w=(n-o)/t,this._x=(i+a)/t,this._y=.25*t,this._z=(h+l)/t}else{const t=2*Math.sqrt(1+c-s-r);this._w=(a-i)/t,this._x=(n+o)/t,this._y=(h+l)/t,this._z=.25*t}return this._onChangeCallback(),this}setFromUnitVectors(t,e){let s=t.dot(e)+1;return s<Number.EPSILON?(s=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=s):(this._x=0,this._y=-t.z,this._z=t.y,this._w=s)):(this._x=t.y*e.z-t.z*e.y,this._y=t.z*e.x-t.x*e.z,this._z=t.x*e.y-t.y*e.x,this._w=s),this.normalize()}angleTo(t){return 2*Math.acos(Math.abs(U(this.dot(t),-1,1)))}rotateTowards(t,e){const s=this.angleTo(t);if(0===s)return this;const i=Math.min(1,e/s);return this.slerp(t,i),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this}multiply(t,e){return void 0!==e?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,e)):this.multiplyQuaternions(this,t)}premultiply(t){return this.multiplyQuaternions(t,this)}multiplyQuaternions(t,e){const s=t._x,i=t._y,n=t._z,a=t._w,r=e._x,h=e._y,o=e._z,l=e._w;return this._x=s*l+a*r+i*o-n*h,this._y=i*l+a*h+n*r-s*o,this._z=n*l+a*o+s*h-i*r,this._w=a*l-s*r-i*h-n*o,this._onChangeCallback(),this}slerp(t,e){if(0===e)return this;if(1===e)return this.copy(t);const s=this._x,i=this._y,n=this._z,a=this._w;let r=a*t._w+s*t._x+i*t._y+n*t._z;if(r<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,r=-r):this.copy(t),r>=1)return this._w=a,this._x=s,this._y=i,this._z=n,this;const h=1-r*r;if(h<=Number.EPSILON){const t=1-e;return this._w=t*a+e*this._w,this._x=t*s+e*this._x,this._y=t*i+e*this._y,this._z=t*n+e*this._z,this.normalize(),this._onChangeCallback(),this}const o=Math.sqrt(h),l=Math.atan2(o,r),c=Math.sin((1-e)*l)/o,u=Math.sin(e*l)/o;return this._w=a*c+this._w*u,this._x=s*c+this._x*u,this._y=i*c+this._y*u,this._z=n*c+this._z*u,this._onChangeCallback(),this}slerpQuaternions(t,e,s){this.copy(t).slerp(e,s)}random(){const t=Math.random(),e=Math.sqrt(1-t),s=Math.sqrt(t),i=2*Math.PI*Math.random(),n=2*Math.PI*Math.random();return this.set(e*Math.cos(i),s*Math.sin(n),s*Math.cos(n),e*Math.sin(i))}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w}fromArray(t,e=0){return this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t}fromBufferAttribute(t,e){return this._x=t.getX(e),this._y=t.getY(e),this._z=t.getZ(e),this._w=t.getW(e),this}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}}W.prototype.isQuaternion=!0;class Q{constructor(t=0,e=0,s=0){this.x=t,this.y=e,this.z=s}set(t,e,s){return void 0===s&&(s=this.z),this.x=t,this.y=e,this.z=s,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}add(t,e){return void 0!==e?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this}sub(t,e){return void 0!==e?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this}multiply(t,e){return void 0!==e?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,e)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this}multiplyVectors(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this}applyEuler(t){return t&&t.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion($.setFromEuler(t))}applyAxisAngle(t,e){return this.applyQuaternion($.setFromAxisAngle(t,e))}applyMatrix3(t){const e=this.x,s=this.y,i=this.z,n=t.elements;return this.x=n[0]*e+n[3]*s+n[6]*i,this.y=n[1]*e+n[4]*s+n[7]*i,this.z=n[2]*e+n[5]*s+n[8]*i,this}applyNormalMatrix(t){return this.applyMatrix3(t).normalize()}applyMatrix4(t){const e=this.x,s=this.y,i=this.z,n=t.elements,a=1/(n[3]*e+n[7]*s+n[11]*i+n[15]);return this.x=(n[0]*e+n[4]*s+n[8]*i+n[12])*a,this.y=(n[1]*e+n[5]*s+n[9]*i+n[13])*a,this.z=(n[2]*e+n[6]*s+n[10]*i+n[14])*a,this}applyQuaternion(t){const e=this.x,s=this.y,i=this.z,n=t.x,a=t.y,r=t.z,h=t.w,o=h*e+a*i-r*s,l=h*s+r*e-n*i,c=h*i+n*s-a*e,u=-n*e-a*s-r*i;return this.x=o*h+u*-n+l*-r-c*-a,this.y=l*h+u*-a+c*-n-o*-r,this.z=c*h+u*-r+o*-a-l*-n,this}project(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)}unproject(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)}transformDirection(t){const e=this.x,s=this.y,i=this.z,n=t.elements;return this.x=n[0]*e+n[4]*s+n[8]*i,this.y=n[1]*e+n[5]*s+n[9]*i,this.z=n[2]*e+n[6]*s+n[10]*i,this.normalize()}divide(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this}divideScalar(t){return this.multiplyScalar(1/t)}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this}clampLength(t,e){const s=this.length();return this.divideScalar(s||1).multiplyScalar(Math.max(t,Math.min(e,s)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this}lerpVectors(t,e,s){return this.x=t.x+(e.x-t.x)*s,this.y=t.y+(e.y-t.y)*s,this.z=t.z+(e.z-t.z)*s,this}cross(t,e){return void 0!==e?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,e)):this.crossVectors(this,t)}crossVectors(t,e){const s=t.x,i=t.y,n=t.z,a=e.x,r=e.y,h=e.z;return this.x=i*h-n*r,this.y=n*a-s*h,this.z=s*r-i*a,this}projectOnVector(t){const e=t.lengthSq();if(0===e)return this.set(0,0,0);const s=t.dot(this)/e;return this.copy(t).multiplyScalar(s)}projectOnPlane(t){return Z.copy(this).projectOnVector(t),this.sub(Z)}reflect(t){return this.sub(Z.copy(t).multiplyScalar(2*this.dot(t)))}angleTo(t){const e=Math.sqrt(this.lengthSq()*t.lengthSq());if(0===e)return Math.PI/2;const s=this.dot(t)/e;return Math.acos(U(s,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,s=this.y-t.y,i=this.z-t.z;return e*e+s*s+i*i}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)}setFromSpherical(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)}setFromSphericalCoords(t,e,s){const i=Math.sin(e)*t;return this.x=i*Math.sin(s),this.y=Math.cos(e)*t,this.z=i*Math.cos(s),this}setFromCylindrical(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)}setFromCylindricalCoords(t,e,s){return this.x=t*Math.sin(e),this.y=s,this.z=t*Math.cos(e),this}setFromMatrixPosition(t){const e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this}setFromMatrixScale(t){const e=this.setFromMatrixColumn(t,0).length(),s=this.setFromMatrixColumn(t,1).length(),i=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=s,this.z=i,this}setFromMatrixColumn(t,e){return this.fromArray(t.elements,4*e)}setFromMatrix3Column(t,e){return this.fromArray(t.elements,3*e)}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t}fromBufferAttribute(t,e,s){return void 0!==s&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const t=2*(Math.random()-.5),e=Math.random()*Math.PI*2,s=Math.sqrt(1-t**2);return this.x=s*Math.cos(e),this.y=s*Math.sin(e),this.z=t,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}Q.prototype.isVector3=!0;const Z=new Q,$=new W;class J{constructor(t=0,e=0){this.x=t,this.y=e}get width(){return this.x}set width(t){this.x=t}get height(){return this.y}set height(t){this.y=t}set(t,e){return this.x=t,this.y=e,this}setScalar(t){return this.x=t,this.y=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y)}copy(t){return this.x=t.x,this.y=t.y,this}add(t,e){return void 0!==e?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this)}addScalar(t){return this.x+=t,this.y+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this}sub(t,e){return void 0!==e?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this)}subScalar(t){return this.x-=t,this.y-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this}multiply(t){return this.x*=t.x,this.y*=t.y,this}multiplyScalar(t){return this.x*=t,this.y*=t,this}divide(t){return this.x/=t.x,this.y/=t.y,this}divideScalar(t){return this.multiplyScalar(1/t)}applyMatrix3(t){const e=this.x,s=this.y,i=t.elements;return this.x=i[0]*e+i[3]*s+i[6],this.y=i[1]*e+i[4]*s+i[7],this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this}clampLength(t,e){const s=this.length();return this.divideScalar(s||1).multiplyScalar(Math.max(t,Math.min(e,s)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(t){return this.x*t.x+this.y*t.y}cross(t){return this.x*t.y-this.y*t.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,s=this.y-t.y;return e*e+s*s}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this}lerpVectors(t,e,s){return this.x=t.x+(e.x-t.x)*s,this.y=t.y+(e.y-t.y)*s,this}equals(t){return t.x===this.x&&t.y===this.y}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t}fromBufferAttribute(t,e,s){return void 0!==s&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this}rotateAround(t,e){const s=Math.cos(e),i=Math.sin(e),n=this.x-t.x,a=this.y-t.y;return this.x=n*s-a*i+t.x,this.y=n*i+a*s+t.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}J.prototype.isVector2=!0;class K{constructor(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}set(t,e,s,i,n,a,r,h,o,l,c,u,d,p,m,v){const g=this.elements;return g[0]=t,g[4]=e,g[8]=s,g[12]=i,g[1]=n,g[5]=a,g[9]=r,g[13]=h,g[2]=o,g[6]=l,g[10]=c,g[14]=u,g[3]=d,g[7]=p,g[11]=m,g[15]=v,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new K).fromArray(this.elements)}copy(t){const e=this.elements,s=t.elements;return e[0]=s[0],e[1]=s[1],e[2]=s[2],e[3]=s[3],e[4]=s[4],e[5]=s[5],e[6]=s[6],e[7]=s[7],e[8]=s[8],e[9]=s[9],e[10]=s[10],e[11]=s[11],e[12]=s[12],e[13]=s[13],e[14]=s[14],e[15]=s[15],this}copyPosition(t){const e=this.elements,s=t.elements;return e[12]=s[12],e[13]=s[13],e[14]=s[14],this}setFromMatrix3(t){const e=t.elements;return this.set(e[0],e[3],e[6],0,e[1],e[4],e[7],0,e[2],e[5],e[8],0,0,0,0,1),this}extractBasis(t,e,s){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),s.setFromMatrixColumn(this,2),this}makeBasis(t,e,s){return this.set(t.x,e.x,s.x,0,t.y,e.y,s.y,0,t.z,e.z,s.z,0,0,0,0,1),this}extractRotation(t){const e=this.elements,s=t.elements,i=1/tt.setFromMatrixColumn(t,0).length(),n=1/tt.setFromMatrixColumn(t,1).length(),a=1/tt.setFromMatrixColumn(t,2).length();return e[0]=s[0]*i,e[1]=s[1]*i,e[2]=s[2]*i,e[3]=0,e[4]=s[4]*n,e[5]=s[5]*n,e[6]=s[6]*n,e[7]=0,e[8]=s[8]*a,e[9]=s[9]*a,e[10]=s[10]*a,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromEuler(t){t&&t.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");const e=this.elements,s=t.x,i=t.y,n=t.z,a=Math.cos(s),r=Math.sin(s),h=Math.cos(i),o=Math.sin(i),l=Math.cos(n),c=Math.sin(n);if("XYZ"===t.order){const t=a*l,s=a*c,i=r*l,n=r*c;e[0]=h*l,e[4]=-h*c,e[8]=o,e[1]=s+i*o,e[5]=t-n*o,e[9]=-r*h,e[2]=n-t*o,e[6]=i+s*o,e[10]=a*h}else if("YXZ"===t.order){const t=h*l,s=h*c,i=o*l,n=o*c;e[0]=t+n*r,e[4]=i*r-s,e[8]=a*o,e[1]=a*c,e[5]=a*l,e[9]=-r,e[2]=s*r-i,e[6]=n+t*r,e[10]=a*h}else if("ZXY"===t.order){const t=h*l,s=h*c,i=o*l,n=o*c;e[0]=t-n*r,e[4]=-a*c,e[8]=i+s*r,e[1]=s+i*r,e[5]=a*l,e[9]=n-t*r,e[2]=-a*o,e[6]=r,e[10]=a*h}else if("ZYX"===t.order){const t=a*l,s=a*c,i=r*l,n=r*c;e[0]=h*l,e[4]=i*o-s,e[8]=t*o+n,e[1]=h*c,e[5]=n*o+t,e[9]=s*o-i,e[2]=-o,e[6]=r*h,e[10]=a*h}else if("YZX"===t.order){const t=a*h,s=a*o,i=r*h,n=r*o;e[0]=h*l,e[4]=n-t*c,e[8]=i*c+s,e[1]=c,e[5]=a*l,e[9]=-r*l,e[2]=-o*l,e[6]=s*c+i,e[10]=t-n*c}else if("XZY"===t.order){const t=a*h,s=a*o,i=r*h,n=r*o;e[0]=h*l,e[4]=-c,e[8]=o*l,e[1]=t*c+n,e[5]=a*l,e[9]=s*c-i,e[2]=i*c-s,e[6]=r*l,e[10]=n*c+t}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromQuaternion(t){return this.compose(st,t,it)}lookAt(t,e,s){const i=this.elements;return rt.subVectors(t,e),0===rt.lengthSq()&&(rt.z=1),rt.normalize(),nt.crossVectors(s,rt),0===nt.lengthSq()&&(1===Math.abs(s.z)?rt.x+=1e-4:rt.z+=1e-4,rt.normalize(),nt.crossVectors(s,rt)),nt.normalize(),at.crossVectors(rt,nt),i[0]=nt.x,i[4]=at.x,i[8]=rt.x,i[1]=nt.y,i[5]=at.y,i[9]=rt.y,i[2]=nt.z,i[6]=at.z,i[10]=rt.z,this}multiply(t,e){return void 0!==e?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,e)):this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const s=t.elements,i=e.elements,n=this.elements,a=s[0],r=s[4],h=s[8],o=s[12],l=s[1],c=s[5],u=s[9],d=s[13],p=s[2],m=s[6],v=s[10],g=s[14],y=s[3],x=s[7],w=s[11],f=s[15],b=i[0],_=i[4],E=i[8],S=i[12],C=i[1],M=i[5],z=i[9],T=i[13],H=i[2],L=i[6],P=i[10],A=i[14],I=i[3],k=i[7],N=i[11],D=i[15];return n[0]=a*b+r*C+h*H+o*I,n[4]=a*_+r*M+h*L+o*k,n[8]=a*E+r*z+h*P+o*N,n[12]=a*S+r*T+h*A+o*D,n[1]=l*b+c*C+u*H+d*I,n[5]=l*_+c*M+u*L+d*k,n[9]=l*E+c*z+u*P+d*N,n[13]=l*S+c*T+u*A+d*D,n[2]=p*b+m*C+v*H+g*I,n[6]=p*_+m*M+v*L+g*k,n[10]=p*E+m*z+v*P+g*N,n[14]=p*S+m*T+v*A+g*D,n[3]=y*b+x*C+w*H+f*I,n[7]=y*_+x*M+w*L+f*k,n[11]=y*E+x*z+w*P+f*N,n[15]=y*S+x*T+w*A+f*D,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this}determinant(){const t=this.elements,e=t[0],s=t[4],i=t[8],n=t[12],a=t[1],r=t[5],h=t[9],o=t[13],l=t[2],c=t[6],u=t[10],d=t[14];return t[3]*(+n*h*c-i*o*c-n*r*u+s*o*u+i*r*d-s*h*d)+t[7]*(+e*h*d-e*o*u+n*a*u-i*a*d+i*o*l-n*h*l)+t[11]*(+e*o*c-e*r*d-n*a*c+s*a*d+n*r*l-s*o*l)+t[15]*(-i*r*l-e*h*c+e*r*u+i*a*c-s*a*u+s*h*l)}transpose(){const t=this.elements;let e;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this}setPosition(t,e,s){const i=this.elements;return t.isVector3?(i[12]=t.x,i[13]=t.y,i[14]=t.z):(i[12]=t,i[13]=e,i[14]=s),this}invert(){const t=this.elements,e=t[0],s=t[1],i=t[2],n=t[3],a=t[4],r=t[5],h=t[6],o=t[7],l=t[8],c=t[9],u=t[10],d=t[11],p=t[12],m=t[13],v=t[14],g=t[15],y=c*v*o-m*u*o+m*h*d-r*v*d-c*h*g+r*u*g,x=p*u*o-l*v*o-p*h*d+a*v*d+l*h*g-a*u*g,w=l*m*o-p*c*o+p*r*d-a*m*d-l*r*g+a*c*g,f=p*c*h-l*m*h-p*r*u+a*m*u+l*r*v-a*c*v,b=e*y+s*x+i*w+n*f;if(0===b)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const _=1/b;return t[0]=y*_,t[1]=(m*u*n-c*v*n-m*i*d+s*v*d+c*i*g-s*u*g)*_,t[2]=(r*v*n-m*h*n+m*i*o-s*v*o-r*i*g+s*h*g)*_,t[3]=(c*h*n-r*u*n-c*i*o+s*u*o+r*i*d-s*h*d)*_,t[4]=x*_,t[5]=(l*v*n-p*u*n+p*i*d-e*v*d-l*i*g+e*u*g)*_,t[6]=(p*h*n-a*v*n-p*i*o+e*v*o+a*i*g-e*h*g)*_,t[7]=(a*u*n-l*h*n+l*i*o-e*u*o-a*i*d+e*h*d)*_,t[8]=w*_,t[9]=(p*c*n-l*m*n-p*s*d+e*m*d+l*s*g-e*c*g)*_,t[10]=(a*m*n-p*r*n+p*s*o-e*m*o-a*s*g+e*r*g)*_,t[11]=(l*r*n-a*c*n-l*s*o+e*c*o+a*s*d-e*r*d)*_,t[12]=f*_,t[13]=(l*m*i-p*c*i+p*s*u-e*m*u-l*s*v+e*c*v)*_,t[14]=(p*r*i-a*m*i-p*s*h+e*m*h+a*s*v-e*r*v)*_,t[15]=(a*c*i-l*r*i+l*s*h-e*c*h-a*s*u+e*r*u)*_,this}scale(t){const e=this.elements,s=t.x,i=t.y,n=t.z;return e[0]*=s,e[4]*=i,e[8]*=n,e[1]*=s,e[5]*=i,e[9]*=n,e[2]*=s,e[6]*=i,e[10]*=n,e[3]*=s,e[7]*=i,e[11]*=n,this}getMaxScaleOnAxis(){const t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],s=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],i=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,s,i))}makeTranslation(t,e,s){return this.set(1,0,0,t,0,1,0,e,0,0,1,s,0,0,0,1),this}makeRotationX(t){const e=Math.cos(t),s=Math.sin(t);return this.set(1,0,0,0,0,e,-s,0,0,s,e,0,0,0,0,1),this}makeRotationY(t){const e=Math.cos(t),s=Math.sin(t);return this.set(e,0,s,0,0,1,0,0,-s,0,e,0,0,0,0,1),this}makeRotationZ(t){const e=Math.cos(t),s=Math.sin(t);return this.set(e,-s,0,0,s,e,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(t,e){const s=Math.cos(e),i=Math.sin(e),n=1-s,a=t.x,r=t.y,h=t.z,o=n*a,l=n*r;return this.set(o*a+s,o*r-i*h,o*h+i*r,0,o*r+i*h,l*r+s,l*h-i*a,0,o*h-i*r,l*h+i*a,n*h*h+s,0,0,0,0,1),this}makeScale(t,e,s){return this.set(t,0,0,0,0,e,0,0,0,0,s,0,0,0,0,1),this}makeShear(t,e,s,i,n,a){return this.set(1,s,n,0,t,1,a,0,e,i,1,0,0,0,0,1),this}compose(t,e,s){const i=this.elements,n=e._x,a=e._y,r=e._z,h=e._w,o=n+n,l=a+a,c=r+r,u=n*o,d=n*l,p=n*c,m=a*l,v=a*c,g=r*c,y=h*o,x=h*l,w=h*c,f=s.x,b=s.y,_=s.z;return i[0]=(1-(m+g))*f,i[1]=(d+w)*f,i[2]=(p-x)*f,i[3]=0,i[4]=(d-w)*b,i[5]=(1-(u+g))*b,i[6]=(v+y)*b,i[7]=0,i[8]=(p+x)*_,i[9]=(v-y)*_,i[10]=(1-(u+m))*_,i[11]=0,i[12]=t.x,i[13]=t.y,i[14]=t.z,i[15]=1,this}decompose(t,e,s){const i=this.elements;let n=tt.set(i[0],i[1],i[2]).length();const a=tt.set(i[4],i[5],i[6]).length(),r=tt.set(i[8],i[9],i[10]).length();this.determinant()<0&&(n=-n),t.x=i[12],t.y=i[13],t.z=i[14],et.copy(this);const h=1/n,o=1/a,l=1/r;return et.elements[0]*=h,et.elements[1]*=h,et.elements[2]*=h,et.elements[4]*=o,et.elements[5]*=o,et.elements[6]*=o,et.elements[8]*=l,et.elements[9]*=l,et.elements[10]*=l,e.setFromRotationMatrix(et),s.x=n,s.y=a,s.z=r,this}makePerspective(t,e,s,i,n,a){void 0===a&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");const r=this.elements,h=2*n/(e-t),o=2*n/(s-i),l=(e+t)/(e-t),c=(s+i)/(s-i),u=-(a+n)/(a-n),d=-2*a*n/(a-n);return r[0]=h,r[4]=0,r[8]=l,r[12]=0,r[1]=0,r[5]=o,r[9]=c,r[13]=0,r[2]=0,r[6]=0,r[10]=u,r[14]=d,r[3]=0,r[7]=0,r[11]=-1,r[15]=0,this}makeOrthographic(t,e,s,i,n,a){const r=this.elements,h=1/(e-t),o=1/(s-i),l=1/(a-n),c=(e+t)*h,u=(s+i)*o,d=(a+n)*l;return r[0]=2*h,r[4]=0,r[8]=0,r[12]=-c,r[1]=0,r[5]=2*o,r[9]=0,r[13]=-u,r[2]=0,r[6]=0,r[10]=-2*l,r[14]=-d,r[3]=0,r[7]=0,r[11]=0,r[15]=1,this}equals(t){const e=this.elements,s=t.elements;for(let t=0;t<16;t++)if(e[t]!==s[t])return!1;return!0}fromArray(t,e=0){for(let s=0;s<16;s++)this.elements[s]=t[s+e];return this}toArray(t=[],e=0){const s=this.elements;return t[e]=s[0],t[e+1]=s[1],t[e+2]=s[2],t[e+3]=s[3],t[e+4]=s[4],t[e+5]=s[5],t[e+6]=s[6],t[e+7]=s[7],t[e+8]=s[8],t[e+9]=s[9],t[e+10]=s[10],t[e+11]=s[11],t[e+12]=s[12],t[e+13]=s[13],t[e+14]=s[14],t[e+15]=s[15],t}}K.prototype.isMatrix4=!0;const tt=new Q,et=new K,st=new Q(0,0,0),it=new Q(1,1,1),nt=new Q,at=new Q,rt=new Q;function ht(){let t=0,e=0,s=0,i=0;function n(n,a,r,h){t=n,e=r,s=-3*n+3*a-2*r-h,i=2*n-2*a+r+h}return{initCatmullRom:function(t,e,s,i,a){n(e,s,a*(s-t),a*(i-e))},initNonuniformCatmullRom:function(t,e,s,i,a,r,h){let o=(e-t)/a-(s-t)/(a+r)+(s-e)/r,l=(s-e)/r-(i-e)/(r+h)+(i-s)/h;o*=r,l*=r,n(e,s,o,l)},calc:function(n){const a=n*n;return t+e*n+s*a+i*(a*n)}}}const ot=new Q,lt=new ht,ct=new ht,ut=new ht;class dt extends class{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(t,e){const s=this.getUtoTmapping(t);return this.getPoint(s,e)}getPoints(t=5){const e=[];for(let s=0;s<=t;s++)e.push(this.getPoint(s/t));return e}getSpacedPoints(t=5){const e=[];for(let s=0;s<=t;s++)e.push(this.getPointAt(s/t));return e}getLength(){const t=this.getLengths();return t[t.length-1]}getLengths(t=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const e=[];let s,i=this.getPoint(0),n=0;e.push(0);for(let a=1;a<=t;a++)s=this.getPoint(a/t),n+=s.distanceTo(i),e.push(n),i=s;return this.cacheArcLengths=e,e}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(t,e){const s=this.getLengths();let i=0;const n=s.length;let a;a=e||t*s[n-1];let r,h=0,o=n-1;for(;h<=o;)if(i=Math.floor(h+(o-h)/2),r=s[i]-a,r<0)h=i+1;else{if(!(r>0)){o=i;break}o=i-1}if(i=o,s[i]===a)return i/(n-1);const l=s[i];return(i+(a-l)/(s[i+1]-l))/(n-1)}getTangent(t,e){let s=t-1e-4,i=t+1e-4;s<0&&(s=0),i>1&&(i=1);const n=this.getPoint(s),a=this.getPoint(i),r=e||(n.isVector2?new J:new Q);return r.copy(a).sub(n).normalize(),r}getTangentAt(t,e){const s=this.getUtoTmapping(t);return this.getTangent(s,e)}computeFrenetFrames(t,e){const s=new Q,i=[],n=[],a=[],r=new Q,h=new K;for(let e=0;e<=t;e++){const s=e/t;i[e]=this.getTangentAt(s,new Q)}n[0]=new Q,a[0]=new Q;let o=Number.MAX_VALUE;const l=Math.abs(i[0].x),c=Math.abs(i[0].y),u=Math.abs(i[0].z);l<=o&&(o=l,s.set(1,0,0)),c<=o&&(o=c,s.set(0,1,0)),u<=o&&s.set(0,0,1),r.crossVectors(i[0],s).normalize(),n[0].crossVectors(i[0],r),a[0].crossVectors(i[0],n[0]);for(let e=1;e<=t;e++){if(n[e]=n[e-1].clone(),a[e]=a[e-1].clone(),r.crossVectors(i[e-1],i[e]),r.length()>Number.EPSILON){r.normalize();const t=Math.acos(U(i[e-1].dot(i[e]),-1,1));n[e].applyMatrix4(h.makeRotationAxis(r,t))}a[e].crossVectors(i[e],n[e])}if(!0===e){let e=Math.acos(U(n[0].dot(n[t]),-1,1));e/=t,i[0].dot(r.crossVectors(n[0],n[t]))>0&&(e=-e);for(let s=1;s<=t;s++)n[s].applyMatrix4(h.makeRotationAxis(i[s],e*s)),a[s].crossVectors(i[s],n[s])}return{tangents:i,normals:n,binormals:a}}clone(){return(new this.constructor).copy(this)}copy(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}toJSON(){const t={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return t.arcLengthDivisions=this.arcLengthDivisions,t.type=this.type,t}fromJSON(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}}{constructor(t=[],e=!1,s="centripetal",i=.5){super(),this.type="CatmullRomCurve3",this.points=t,this.closed=e,this.curveType=s,this.tension=i}getPoint(t,e=new Q){const s=e,i=this.points,n=i.length,a=(n-(this.closed?0:1))*t;let r,h,o=Math.floor(a),l=a-o;this.closed?o+=o>0?0:(Math.floor(Math.abs(o)/n)+1)*n:0===l&&o===n-1&&(o=n-2,l=1),this.closed||o>0?r=i[(o-1)%n]:(ot.subVectors(i[0],i[1]).add(i[0]),r=ot);const c=i[o%n],u=i[(o+1)%n];if(this.closed||o+2<n?h=i[(o+2)%n]:(ot.subVectors(i[n-1],i[n-2]).add(i[n-1]),h=ot),"centripetal"===this.curveType||"chordal"===this.curveType){const t="chordal"===this.curveType?.5:.25;let e=Math.pow(r.distanceToSquared(c),t),s=Math.pow(c.distanceToSquared(u),t),i=Math.pow(u.distanceToSquared(h),t);s<1e-4&&(s=1),e<1e-4&&(e=s),i<1e-4&&(i=s),lt.initNonuniformCatmullRom(r.x,c.x,u.x,h.x,e,s,i),ct.initNonuniformCatmullRom(r.y,c.y,u.y,h.y,e,s,i),ut.initNonuniformCatmullRom(r.z,c.z,u.z,h.z,e,s,i)}else"catmullrom"===this.curveType&&(lt.initCatmullRom(r.x,c.x,u.x,h.x,this.tension),ct.initCatmullRom(r.y,c.y,u.y,h.y,this.tension),ut.initCatmullRom(r.z,c.z,u.z,h.z,this.tension));return s.set(lt.calc(l),ct.calc(l),ut.calc(l)),s}copy(t){super.copy(t),this.points=[];for(let e=0,s=t.points.length;e<s;e++){const s=t.points[e];this.points.push(s.clone())}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this}toJSON(){const t=super.toJSON();t.points=[];for(let e=0,s=this.points.length;e<s;e++){const s=this.points[e];t.points.push(s.toArray())}return t.closed=this.closed,t.curveType=this.curveType,t.tension=this.tension,t}fromJSON(t){super.fromJSON(t),this.points=[];for(let e=0,s=t.points.length;e<s;e++){const s=t.points[e];this.points.push((new Q).fromArray(s))}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this}}dt.prototype.isCatmullRomCurve3=!0;class pt extends V{constructor(t=[],e=1,s=0){for(super(0,0,0,0,e,s),this.type="ActionSwipe",this.name.value="Mouse gesture",this.description.value="Add a mouse gesture",this.points=new w,this.points.dataClass=B;t.length<2;)t.push(new B);this.points.value=t,this.isCaptureable.value=!0,this.isTestable.value=!0,this.smoothness=new y(20),this.changeCursorOnCapture.value=!0,this.icon.value="fas fa-arrows-alt",this.captureDownHandler=this.captureDownHandler.bind(this),this.captureMoveHandler=this.captureMoveHandler.bind(this),this.captureUpHandler=this.captureUpHandler.bind(this)}clone(){let t=new pt;return t.copy(this),t}copy(t){super.copy(t);let e=[];t.points.map(t=>{e.push(t.clone())}),this.points.value=e}serialize(){let t=super.serialize();return t.points=this.points.serialize(),t}deserialize(t){t&&(super.deserialize(t),this.points.deserialize(t.points))}trigger(){this.startX.value=0,this.startY.value=0,this.endX.value=1,this.endY.value=0;let t=[];return this.points.map(e=>{t.push(new Q(e.x.value,e.y.value,0))}),this.curve=new dt(t,!1,"chordal",.75),this.dispatchMouseEvent("mousedown",0),super.trigger()}dispatchMouseEvent(t,e){e=Math.min(e,1),e=Math.max(e,0);let s=this.curve.getPoint(e);s.x=s.x-window.scrollX,s.y=s.y-window.scrollY;let i=document.elementFromPoint(s.x,s.y),n=new MouseEvent(t,{bubbles:!0,cancelable:!0,view:window,clientX:s.x,clientY:s.y,pageX:s.x,pageY:s.y,x:s.x,y:s.y});i.dispatchEvent(n)}tweenUpdateHandler(){this.dispatchMouseEvent("mousemove",this.pos.x)}tweenCompleteHandler(t){this.dispatchMouseEvent("mouseup",1)}capture(){super.capture(),document.body.addEventListener(c.mousedown,this.captureDownHandler)}captureDownHandler(t){let e=t;o&&(e=t.touches[0]);let s=new a(e.pageX,e.pageY);this.capturedPoints=[new B(s.x,s.y)],this.lastPoint=s,this.startDate=new Date,document.body.removeEventListener(c.mousedown,this.captureDownHandler),document.body.addEventListener(c.mousemove,this.captureMoveHandler),document.body.addEventListener(c.mouseup,this.captureUpHandler)}captureMoveHandler(t){let e=t;o&&(e=t.touches[0]);let s=new a(e.pageX,e.pageY);a.distance(this.lastPoint,s)>this.smoothness.value&&(this.lastPoint=s,this.capturedPoints.push(new B(s.x,s.y)))}captureUpHandler(t){let e=t;o&&(e=t.touches[0]);let s=new a(e.pageX,e.pageY);a.distance(this.lastPoint,s)>0&&this.capturedPoints.push(new B(s.x,s.y)),this.points.value=this.capturedPoints,this.capturedPoints=[];let i=Object(n.i)((new Date-this.startDate)/1e3,1);this.duration.value=i,document.body.removeEventListener(c.mousemove,this.captureMoveHandler),document.body.removeEventListener(c.mouseup,this.captureUpHandler),this.captureComplete()}captureAtInit(){super.captureAtInit(),this.capture()}}class mt extends _{constructor(){super("ActionWait","Pause","Add a pause"),this.delay.value=1,this.icon.value="fas fa-pause-circle"}clone(){let t=new mt;return t.copy(this),t}}class vt extends w{constructor(){super(),this.push.apply(this,arguments),this.types=new w,this.types.value=[new Y,new q,new pt,new j,new mt]}cloneAction(t){let e=t.clone();this.addAction(e)}addAction(t){if(!t)return;Object(i.a)("Action","add",t.type),t.captureAtInit();let e=this.selectedIndex.value+1;isNaN(e)&&(e=this.value.length),this.splice(e,0,t),this.selectedIndex.value=e}removeAction(t){Object(i.a)("Action","remove",t.type);let e=this.indexOf(t);this.remove(t);let s=Math.max(e-1,0);this.selectedIndex.value=Math.min(s,this.value.length-1)}serialize(){let t=[];return this.map(e=>{t.push(e.serialize())}),t}deserialize(t){if(!t)return;let e=[];for(let s=0;s<t.length;s++){let i=t[s],n=this.types.find(t=>t.type==i.type).clone();n.deserialize(i),e.push(n)}this.value=e}}class gt{constructor(t,e=500){this.callback=t,this.timeout=e,this.throttle=this.throttle.bind(this),this.timeoutComplete=this.timeoutComplete.bind(this),this.isWaiting=!1,this.doCallback=!1}throttle(t){this.data=t,this.doCallback=!0,this.isWaiting||this.timeoutComplete()}timeoutComplete(){this.doCallback?(this.isWaiting=!0,this.callback(this.data),this.doCallback=!1,setTimeout(this.timeoutComplete,this.timeout)):this.isWaiting=!1}}class yt{constructor(){this.darkModeChangeHandler=this.darkModeChangeHandler.bind(this),this.position=new B(50,50),this.windowSizeChangeHandler=this.windowSizeChangeHandler.bind(this),this.windowResizeHandler=this.windowResizeHandler.bind(this),this.windowSize=new B(window.innerWidth,window.innerHeight),this.windowSize.addEventListener(m.CHANGE,this.windowSizeChangeHandler),window.addEventListener("resize",this.windowResizeHandler),this.videoBitsPerSecondThrottle=new gt(()=>{Object(i.a)("settings","videoBitsPerSecond",this.videoBitsPerSecond.value)},1e3),this.videoBitsPerSecondMin=1,this.videoBitsPerSecondMax=8,this.videoBitsPerSecond=new y,this.videoBitsPerSecond.value=8,this.videoBitsPerSecond.addEventListener(m.CHANGE,this.videoBitsPerSecondThrottle.throttle),this.videoCodecs=new w("vp8","vp9","h264"),this.videoCodecs.selectedItem.value=this.videoCodecs.value[0],this.videoCodecs.selectedItem.addEventListener(m.CHANGE,()=>{Object(i.a)("settings","videoCodec",this.videoCodecs.selectedItem.value)}),this.audioBitsPerSecondThrottle=new gt(()=>{Object(i.a)("settings","audioBitsPerSecond",this.audioBitsPerSecond.value)},1e3),this.audioBitsPerSecond=new y(128),this.audioBitsPerSecond.addEventListener(m.CHANGE,this.audioBitsPerSecondThrottle.throttle),this.audioCodecs=new w("opus"),this.audioCodecs.selectedItem.value=this.audioCodecs.value[0],this.audioCodecs.selectedItem.addEventListener(m.CHANGE,()=>{Object(i.a)("settings","audioCodec",this.audioCodecs.selectedItem.value)}),this.darkModeMatchMedia=window.matchMedia("(prefers-color-scheme: dark)"),this.isColorThemeLight=new g,this.isColorThemeLight.addEventListener(m.CHANGE,t=>{let e={txt:"scrollCaptureColorTheme",isColorThemeLight:t.data};Gt.model.sendMessage(e)}),this.colorThemes=new w("Dark","Light","Auto"),this.colorThemes.selectedItem.value="Dark",this.switchColorTheme(),this.colorThemes.selectedItem.addEventListener(m.CHANGE,()=>{Object(i.a)("settings","colorTheme",this.colorThemes.selectedItem.value),this.switchColorTheme()})}windowResizeHandler(){this.windowSize.removeEventListener(m.CHANGE,this.windowSizeChangeHandler),this.windowSize.x.value=window.innerWidth,this.windowSize.y.value=window.innerHeight,this.windowSize.addEventListener(m.CHANGE,this.windowSizeChangeHandler)}windowSizeChangeHandler(){Gt.model.sendMessage({txt:"scrollCaptureResizeWindow",width:this.windowSize.x.value,height:this.windowSize.y.value})}switchColorTheme(){let t=this.colorThemes.selectedItem.value;switch(t){case"Dark":case"Light":this.darkModeMatchMedia.removeEventListener("change",this.darkModeChangeHandler),this.isColorThemeLight.value="Light"==t;break;default:this.darkModeMatchMedia.addEventListener("change",this.darkModeChangeHandler),this.darkModeChangeHandler()}}darkModeChangeHandler(){let t=this.darkModeMatchMedia.matches;this.isColorThemeLight.value=!t}serialize(){return{position:this.position.serialize(),videoBitsPerSecond:this.videoBitsPerSecond.serialize(),videoCodec:this.videoCodecs.selectedItem.serialize(),audioBitsPerSecond:this.audioBitsPerSecond.serialize(),audioCodec:this.audioCodecs.selectedItem.serialize(),colorThemes:this.colorThemes.selectedItem.value}}deserialize(t){t&&(this.position.deserialize(t.position),this.videoBitsPerSecond.deserialize(t.videoBitsPerSecond),this.videoCodecs.selectedItem.deserialize(t.videoCodec),this.audioBitsPerSecond.deserialize(t.audioBitsPerSecond),this.audioCodecs.selectedItem.deserialize(t.audioCodec),t.hasOwnProperty("colorThemes")&&(this.colorThemes.selectedItem.value=t.colorThemes))}}class xt extends R{constructor(){super({selectedAction:"Pause"}),this.save=this.save.bind(this),this.showCaptureIcon=new g,this.isSaving=new g,this.settings=new yt,this.actions=new vt,this.actions.addEventListener("add",t=>{this.save()}),this.actions.addEventListener("remove",t=>{this.save()})}get actions(){return this._actions}set actions(t){this._actions=t,this.dispatchEvent(new d("change_actions",t))}sendMessage(t){chrome.runtime.sendMessage(t)}save(){this.isSaving.value=!0;let t={actions:this.actions.serialize(),settings:this.settings.serialize()},e=JSON.stringify(t);chrome.storage.local.set({json:e},()=>{setTimeout(()=>{this.isSaving.value=!1},100)})}clearActions(){Object(i.a)("clearActions","click"),this.actions.clear(),this.save()}}class wt extends EventTarget{constructor({load:t,show:e,hide:s,branches:i,defaultChild:n,getBranch:a}={}){super(),this.branches=i||{},t&&(this.load=t),e&&(this.show=e),s&&(this.hide=s),a&&(this.getBranch=a),this._defaultChild=n,this._parent=null,this._path=null,this._router=null,this._slug=null}getBranch(t){let e;return this.branches[t]?e=this.branches[t]:this.branches["*"]?e=this.branches["*"]:(e=new wt,console.log("No branch named "+t+", default branch was created")),e}load(t,e){return Promise.resolve()}show(t){return Promise.resolve()}hide(t){return Promise.resolve()}get defaultChild(){return this._defaultChild}set defaultChild(t){this._defaultChild=t}get parent(){return this._parent}set parent(t){this._parent=t}get path(){return this._path}set path(t){this._path=t}get router(){return this._router}set router(t){this._router=t}get slug(){return this._slug}set slug(t){this._slug=t}}class ft{constructor(t,e,s,i=!0){this.eventTarget=t,this.type=e,this.eventHandler=s,this.enabled=i}set enabled(t){this._enabled=t,t?this.eventTarget.addEventListener(this.type,this.eventHandler):this.eventTarget.removeEventListener(this.type,this.eventHandler)}destroy(){this.enabled=!1,this.eventTarget=null,this.type=null,this.eventHandler=null}}function bt(t){return null!=t&&null!=t&&""!=t}class _t extends EventTarget{constructor(t,e,s=null){super(),this.changeHandler=this.changeHandler.bind(this),this._value=null,this.getValue=new Function("return "+t).bind(e),this.callback=s;let i=t;for(let t=0;t<"+/*-[](){}!?%$=:;`".length;t++){let e="+/*-[](){}!?%$=:;`".charAt(t);i=i.split(e).join(" ")}let n=i.split(" ").filter(t=>bt(t)&&-1==t.indexOf("'")&&-1==t.indexOf('"'));this.eventHandlers=[],n.map((t,s)=>{let i=t.split("."),n=e,a=i.pop();if(i.length>0&&(n=P(i.join("."),e)),n instanceof EventTarget&&null!=n[a]){let t=new ft(n,a,this.changeHandler);this.eventHandlers.push(t)}}),this.changeHandler()}get value(){return this._value}changeHandler(t=null){this._value=this.getValue(),p.dispatch(this,"value",this.value),this.callback&&this.callback(this.value)}destroy(){this.eventHandlers.map(t=>{t.destroy()}),this.eventHandlers=[],this.callback=null,this._value=null}}var Et=s(2);class St{constructor(t,e,s,i){this.changeHandler1=this.changeHandler1.bind(this),this.changeHandler2=this.changeHandler2.bind(this),this.eventHandler1=this.createEventHandler(t,e,this.changeHandler1),this.eventHandler2=this.createEventHandler(s,i,this.changeHandler2.bind(this)),this.changeHandler2(new p(this.eventHandler2.type,this.eventHandler2.eventTarget[this.eventHandler2.type]))}changeHandler1(t){this.eventHandler2.enabled=!1,this.eventHandler2.eventTarget[this.eventHandler2.type]=t.data,this.eventHandler2.enabled=!0}changeHandler2(t){this.eventHandler1.enabled=!1,this.eventHandler1.eventTarget[this.eventHandler1.type]=t.data,this.eventHandler1.enabled=!0}createEventHandler(t,e,s){let i,n=e.split("."),a=t,r=n.pop();return n.length>0&&(a=P(n.join("."),t)),a instanceof EventTarget?i=new ft(a,r,s):console.log("Object is not an instance of EventTarget, cannot add event listener type '"+r+"'"),i}destroy(){this.eventHandler1.destroy(),this.eventHandler2.destroy()}}class Ct extends wt{constructor(t){super(),t&&(this.debug="true"==t.getAttribute("data-debug")),this.element=t,this.componentID=(new Date).getTime(),this.debug&&this.element.setAttribute("data-componentId",this.componentID),this._model=null,this.rectangle=new r,this.globalRectangle=new r,this.windowSize=new r,this.attributes={},this.showDuration=0,this.showDelay=0,this.hideDuration=0,this.hideDelay=0,this.showChildrenDelay=0,this.hideChildrenDelay=0,this.doChildrenAnimationFrame=!1,this.alsoShowChildren=!1,this.calculateGlobalPosition=!1}get element(){return this._element}set element(t){this._element=t,t&&(t.component=this)}get containerElement(){return this.element}removeChild(t){if(this.debug&&console.log("UIList.removeChild",t),t&&this.containerElement==t.parentNode){t.parentNode.removeChild(t);let e=t.component;e&&this.isAdded&&e.elementRemoved()}}appendChild(t){if(t){this.containerElement.appendChild(t);let e=t.component;e&&(this.isAdded&&e.elementAdded(),e.windowResize&&e.windowResize(this.windowSize))}}prependChild(t){this.appendChildAt(t,0)}appendChildAt(t,e=0){let s=this.children;if(e>=s.length)this.appendChild(t);else{let i=s[e];this.insertBefore(t,i)}}insertBefore(t,e){if(t&&e){this.containerElement.insertBefore(t,e);let s=t.component;s&&(this.isAdded&&s.elementAdded(),s.windowResize&&s.windowResize(this.windowSize))}}insertAfter(t,e){let s=this.children.indexOf(e);isNaN(s)?console.log("Can't find depth index for",e):this.appendChildAt(t,s+1)}setAttribute(t,e){this.element.setAttribute(t,e)}get isAdded(){let t;for(this.element&&(t=this.element.parentNode);t&&t!=document.body;)t=t.parentNode;return t==document.body}get children(){let t=[];var e;return this.element&&(e=this.element.children,t=Array.prototype.slice.call(e)),t}get scope(){return this._scope}set scope(t){this._scope=t,this.debug&&console.log("debug UIComponent.scope",t),function(t){let e=t.element;for(let s=0;s<e.attributes.length;s++){let i=e.attributes[s],n=i.value.split("{").join("${");if(-1!=n.indexOf("${")){const e=e=>{t.setAttribute(i.name,e)};t.attributes[i.name]=new _t(Object(Et.a)("`"+n+"`"),t,e)}}}(this),function(t){const e=[];for(let s=0;s<t.element.attributes.length;s++){const i=t.element.attributes[s];if(-1!=i.name.indexOf("on:")){const s=i.name.split("on:")[1],n=new Function("event",i.value).bind(t);t.attributes[i.name]=new ft(t.element,s,n),e.push(i.name)}}e.map(e=>{t.element.removeAttribute(e)})}(this),function(t,e="set:"){const s=[];for(let i=0;i<t.element.attributes.length;i++){const n=t.element.attributes[i];if(-1!=n.name.indexOf(e)){const i=n.name.split(e)[1],a=e=>{t[i]=e};t.attributes[n.name]=new _t(n.value,t,a),s.push(n.name)}}s.map(e=>{t.element.removeAttribute(e)})}(this),function(t){const e=[];for(let s=0;s<t.element.attributes.length;s++){const i=t.element.attributes[s];if(-1!=i.name.indexOf("bind:")){const s=i.name.split("bind:")[1];t.attributes[i.name]=new St(t,"this."+s,t,i.value),e.push(i.name)}}e.map(e=>{t.element.removeAttribute(e)})}(this)}get model(){return this._model}set model(t){t!=this._model&&(this._model=t,p.dispatch(this,"model",t))}load(){let t=[],e=this.children;for(let s=0;s<e.length;s++){let i=e[s].component;i&&i.load&&t.push(i.load())}return Promise.all(t)}show(t){return f(this.showDelay).then(()=>(this.showPromises=[this.showDelayComplete()],this.alsoShowChildren&&this.showPromises.push(this.showChildren()),Promise.all(this.showPromises))).then(this.showComplete.bind(this))}showDelayComplete(){return this.isVisible=!0,this.element&&this.element.setAttribute("data-state","show"),f(this.showDuration)}showComplete(){}showChildren(){let t=[],e=0,s=this.children;for(let i=0;i<s.length;i++){let n=s[i].component;n&&(this.showChildrenDelay>0&&(n.showDelay=e,e+=this.showChildrenDelay),t.push(n.show()))}return Promise.all(t)}hide(t){return f(this.hideDelay).then(()=>(this.hidePromises=[this.hideDelayComplete()],this.alsoShowChildren&&this.hidePromises.push(this.hideChildren()),Promise.all(this.hidePromises))).then(this.hideComplete.bind(this))}hideDelayComplete(){return this.element&&this.element.setAttribute("data-state","hide"),f(this.hideDuration)}hideComplete(){this.isVisible=!1}hideChildren(){let t=[],e=0,s=this.children;for(let i=0;i<s.length;i++){let n=s[i].component;n&&(this.hideChildrenDelay>0&&(n.hideDelay=e,e+=this.hideChildrenDelay),t.push(n.hide()))}return Promise.all(t)}windowResize(t){this.windowSize=t,this.rectangle.x=this.element.offsetLeft,this.rectangle.y=this.element.offsetTop,this.rectangle.width=this.element.offsetWidth,this.rectangle.height=this.element.offsetHeight,this.globalRectangle.width=this.rectangle.width,this.globalRectangle.height=this.rectangle.height,this.calculateGlobalPosition&&(this.globalRectangle.position=l(this.element,document.body));let e=this.children;for(let s=0;s<e.length;s++){let i=e[s].component;i&&i.windowResize&&i.windowResize(t)}}animationFrame(t){if(this.animationFrameData=t,this.doChildrenAnimationFrame){let e=this.children;for(let s=0;s<e.length;s++){let i=e[s].component;i&&i.animationFrame(t)}}}orientationChange(t){this.orientation=t;let e=this.children;for(let s=0;s<e.length;s++){let i=e[s].component;i&&i.orientationChange&&i.orientationChange(t)}}elementAdded(){let t=this.children;for(let e=0;e<t.length;e++){let s=t[e].component;s&&s.elementAdded()}}elementRemoved(){let t=this.children;for(let e=0;e<t.length;e++){let s=t[e].component;s&&s.elementRemoved()}}static getRect(t,e,s){e||(e=document.body);let i=new r(0,0,t.offsetWidth,t.offsetHeight);return t.parentNode&&(i.position=l(t,e,null,s)),i}getRect(t,e){return Ct.getRect(this.element,t)}querySelector(t){let e=this.element.querySelector(t);return e||console.log("No element with selector "+t+" in "+this),e.component||e}querySelectorAll(t){let e=[],s=this.element.querySelectorAll(t);for(let t=0;t<s.length;t++){let i=s.item(t);e.push(i.component||i)}return e}getTouchPoint(t){let e=t;return o&&(e=t.touches[0]),new a(e.pageX,e.pageY)}dispatchResizeEvent(){this.element.dispatchEvent(new Event("ui-resize",{bubbles:!0,cancelable:!0}))}destroy(){this.debug&&console.log("UIComponent.destroy",this.element);for(let t in this.attributes){this.attributes[t].destroy()}this.model=null,this.scope=null,this.element.parentNode&&this.element.parentNode.removeChild(this.element),this.element=null,this.element.compopnent=null;for(let t in this)this[t]=null}}class Mt extends Ct{constructor(t){super(t),this.onRelease=()=>{},this.clickHandler=this.clickHandler.bind(this),this.pressHandler=this.pressHandler.bind(this),this.clickDelayComplete=this.clickDelayComplete.bind(this),this.clickDelay=0,this.element.addEventListener(c.click,this.clickHandler),this.element.addEventListener(c.mousedown,this.pressHandler)}pressHandler(t){this.element.setAttribute("data-event","press")}clickHandler(t){this.element.setAttribute("data-event","click"),this.clickDelay>0?setTimeout(this.clickDelayComplete,1e3*this.clickDelay,t):this.clickDelayComplete(t)}clickDelayComplete(t){this.onRelease&&this.onRelease(t)}destroy(){this.element.removeEventListener(c.click,this.clickHandler),this.element.removeEventListener(c.mousedown,this.pressHandler),super.destroy()}}class zt{constructor(t,e=null,s=NaN,i=NaN){this.data=t,this.parentScope=e,this.index=s,isNaN(this.index)||(this.index1=s+1),this.length=i}get rootScope(){let t=this,e=this;for(;e;)t=e,e=t.parentScope;return t}toString(){return"Scope "+this.parentScope}}class Tt extends Ct{constructor(t){super(t),this._providerAdd=this._providerAdd.bind(this),this._providerRemove=this._providerRemove.bind(this),this._providerSort=this._providerSort.bind(this),this.template='<li is="ui-text">{this.scope.data}</li>',this.templates={},this._provider=new w;let e=[];this.element&&this.children.map(t=>{"TEMPLATE"==t.nodeName.toUpperCase()&&e.push(t)});for(let t=0;t<e.length;t++){let s=e[t],i=s.getAttribute("data-type")||"*";this.templates[i]=s.innerHTML,this.element.removeChild(s)}}get provider(){return this._provider}set provider(t){this.debug&&console.log("UIList.provider",t),this._provider&&this._provider instanceof w&&(this._provider.removeEventListener("add",this._providerAdd),this._provider.removeEventListener("remove",this._providerRemove),this._provider.removeEventListener("sort",this._providerSort)),this._removeElements(this.children.slice()),this._provider=t,this._provider&&(this._provider instanceof w?(this._provider.addEventListener("add",this._providerAdd),this._provider.addEventListener("remove",this._providerRemove),this._provider.addEventListener("sort",this._providerSort),this._addElements(this._provider.value)):this._addElements(this._provider))}_removeElements(t){this.debug&&console.log("UIList._removeElements",t.length);for(let e=0;e<t.length;e++){let s=t[e];this.removeChild(s),D(s)}this.dispatchResizeEvent()}_addElements(t,e=0){this.debug&&console.log("UIList._addElements",t.length);for(let s in t){let i=t[s],n=this._createElement(i,e,t.length);this.appendChildAt(n,e),e++}return this.dispatchResizeEvent(),t}_createElement(t,e,s){return N(this._getTemplateForModel(t),new zt(t,this.scope,e,s))}_getModelType(t){let e=t.type;return e instanceof m&&(e=e.value),e}_getTemplateForModel(t){let e;if(t){let s=this._getModelType(t);e=this.templates[s]}if(e||(e=this.templates["*"]||this.template),!e)throw new Error("UIList "+this.element.outerHTML+" has no template");return e}_providerAdd(t){this.debug&&console.log("UIList._providerAdd"),this._saveChildrenPositions();let e=[],s=t.data.index,i=t.data.index+t.data.total;for(let t=s;t<i;t++){let s=this.provider.value[t];e.push(s)}return this._addElements(e,s),this.windowResize(this.windowSize),this._setChildrenTransform(),setTimeout(this._resetChildrenTransform.bind(this),0),e}_providerRemove(t){this.debug&&console.log("UIList._providerRemove",t),this._saveChildrenPositions();let e=this.children;this.debug&&console.log("children=",e);let s=[],i=t.data.index,n=t.data.index+t.data.total;this.debug&&console.log("start=",i,"end=",n);for(let t=i;t<n;t++)s.push(e[t]);return this._removeElements(s),this.windowResize(this.windowSize),this._setChildrenTransform(),setTimeout(this._resetChildrenTransform.bind(this),0),s}_providerSort(t){this._saveChildrenPositions();let e=this.provider.value;for(let t=0;t<e.length;t++){let s=e[t],i=this.getElementByModel(s);i&&this.element.appendChild(i)}this.windowResize(this.windowSize),this._setChildrenTransform(),setTimeout(this._resetChildrenTransform.bind(this),0)}getElementByModel(t){return this.children.find(e=>{let s=!1;return e.component&&(s=e.component.model==t),s})}_saveChildrenPositions(){this.childrenPositions=[],this.children.map(t=>{this.childrenPositions.push({child:t,position:new a(t.offsetLeft,t.offsetTop)})})}_setChildrenTransform(){this.childrenPositions.map((t,e)=>{let s=new a(t.child.offsetLeft,t.child.offsetTop),i=t.position.subtract(s);i.magnitude>0&&(t.child.classList.remove("smooth-transform"),t.child.style.transform="translate3d("+i.x+"px, "+i.y+"px, 0px)")})}_resetChildrenTransform(){this.children.map((t,e)=>{t.classList.add("smooth-transform"),t.style.transform="translate3d(0px, 0px, 0px)"})}scrollToElement(t,e){let s=new a,i=new a;i.x=this.element.scrollWidth-this.element.clientWidth,i.y=this.element.scrollHeight-this.element.clientHeight;let n=new r(t.offsetLeft,t.offsetTop,t.offsetWidth,t.offsetHeight);return s.x=Math.min(n.x,i.x),s.y=Math.min(n.y,i.y),this.scrollTo(s.x,s.y,e)}scrollTo(t,e,s=1){return this.tween=new M(0,s,[new z(this.element,"scrollLeft",this.element.scrollLeft,t,F.cubic.easeInOut,n.f),new z(this.element,"scrollTop",this.element.scrollTop,e,F.cubic.easeInOut,n.f)]),this.tween.start()}destroy(){this.childrenPositions=null,this.provider=null,super.destroy()}}class Ht extends Tt{constructor(t){super(t),this._mouseDownHandler=this._mouseDownHandler.bind(this),this._dragMove=this._dragMove.bind(this),this._dragElementMove=this._dragElementMove.bind(this),this._dragEnd=this._dragEnd.bind(this),this.selectItemOnMouseDown=!1,this.isDragged=!1,this.dragIndex=NaN,this.dragElementClass="ui-list-drag-area",this.element.addEventListener(c.mousedown,this._mouseDownHandler)}_mouseDownHandler(t){let e=NaN,s=this.children.find((s,i)=>{let n=s.contains(t.target),a=s==t.target,r=n||a;return this.debug&&console.log(i,"contains",n,"isChild",a,"isMatch",r),r&&(e=i),r});if(s){this.selectItemOnMouseDown&&this.provider.selectedIndex&&(this.provider.selectedIndex.value=e),t.target.classList.contains(this.dragElementClass)&&(t.preventDefault(),this.dragStartPoint=this.getTouchPoint(t),this.dragIndex=NaN,this.dragElement=s,this.dragIndex=e,this.dragElementStartPos=new a(this.dragElement.offsetLeft,this.dragElement.offsetTop),this.dragElementsMinHeight=Number.MAX_VALUE,this.children.map(t=>{this.dragElementsMinHeight=Math.min(this.dragElementsMinHeight,t.component.rectangle.height)}),document.body.addEventListener(c.mousemove,this._dragMove),document.body.addEventListener(c.mouseup,this._dragEnd))}}_dragMove(t){let e=this.getTouchPoint(t);a.distance(e,this.dragStartPoint)>0&&(document.body.removeEventListener(c.mousemove,this._dragMove),document.body.addEventListener(c.mousemove,this._dragElementMove),this._dragElementStart())}_dragElementStart(){this.isDragged=!0,this.dragElement.classList.add("is-dragged"),this.dragElement.dispatchEvent(new Event("drag-start",{bubbles:!1,cancelable:!0}))}_dragElementMove(t){t.preventDefault();let e=this.getTouchPoint(t),s=e.subtract(this.dragStartPoint),i=s.add(this.dragElementStartPos),n=this.children,r=this.dragIndex;for(let t=n.length-1;t>-1;t--){let e=n[t];i.y<e.component.rectangle.y+this.dragElementsMinHeight/2&&(r=t)}if(r!=this.dragIndex){this.provider.swap(this.dragIndex,r);let t=this.dragElementStartPos;this.dragElementStartPos=new a(this.dragElement.offsetLeft,this.dragElement.offsetTop);let i=this.dragElementStartPos.subtract(t);this.dragStartPoint=this.dragStartPoint.add(i),s=e.subtract(this.dragStartPoint),this.dragIndex=r}this.dragElement.style.transform="translate3d("+s.x+"px, "+s.y+"px, 0px)"}_dragEnd(t){this.isDragged=!1,this.dragElement.classList.remove("is-dragged"),this.dragElement.style.transform="",document.body.removeEventListener(c.mousemove,this._dragMove),document.body.removeEventListener(c.mousemove,this._dragElementMove),document.body.removeEventListener(c.mouseup,this._dragEnd),this.dragStartPoint=null,this.dragIndex=NaN,this.dragElement=null}}class Lt extends Ct{constructor(t){super(t)}get scope(){return super.scope}set scope(t){super.scope=t;let e=this.element.textContent;if(e=e.split("{").join("${"),-1!=e.indexOf("${")){let t=t=>{this.model=t};this.expression=new _t("`"+e+"`",this,t)}}get model(){return this.element.textContent}set model(t){t instanceof m&&(t=t.value),this.element.textContent=t}destroy(){return this.expression&&this.expression.destroy(),super.destroy()}}class Pt extends Ct{constructor(t,e=".panel"){super(t),this.scrollingPanel=this.element.querySelector(e),this.wheelDirection=1,this._autoScrollFactor=0,this.infiniteLoop={x:!1,y:!1},this.loopPoint=new a(0,0),this.autoScrollSpeed=1,this.scrollTarget=new a,this.scroll=new a,this.speed=new a,this.momentum=new a,this.minScroll=new a,this.maxScroll=new a,this.size=new r,this.panelSize=new r,this.startTouchDiff=new a,this.springiness=0,this.inertia=1,this.elasticScrollInertia=.1,this.elasticScrollElasticity=new a(.15,0),this.momentumFriction=.965,this.momentumScaleLimit=.5,this.maxScrollReached={x:new g,y:new g},this.wheelHandler=this.wheelHandler.bind(this),this.mousedownHandler=this.mousedownHandler.bind(this),this.mousemoveHandler=this.mousemoveHandler.bind(this),this.mouseupHandler=this.mouseupHandler.bind(this),this.element.addEventListener(c.mousedown,this.mousedownHandler),this.autoScrollTimeoutDuration=4,this._startAutoScroll=this._startAutoScroll.bind(this),this.debug&&console.log("events",c)}set autoScroll(t){this._autoScroll=t,this._stopAutoScroll(),t&&this._startAutoScroll()}get autoScroll(){return this._autoScroll}get wheelEnabled(){return this._wheelEnabled}set wheelEnabled(t){this._wheelEnabled=t,t?this.addWheelHandler():this.removeWheelHandler()}addWheelHandler(){this.removeWheelHandler(),this.element.addEventListener("wheel",this.wheelHandler)}removeWheelHandler(){this.element.removeEventListener("wheel",this.wheelHandler)}wheelHandler(t){t.preventDefault(),this.stopTween(),this.maxScroll.y>0&&(this.scrollTarget.y+=t.deltaY*this.wheelDirection),this.dispatchEvent(new d(Pt.WHEEL,t))}_startAutoScrollTimeout(){this._stopAutoScrollTimeout(),this.autoScroll&&(this._autoScrollTimeout=setTimeout(this._startAutoScroll,1e3*this.autoScrollTimeoutDuration))}_stopAutoScrollTimeout(){clearTimeout(this._autoScrollTimeout)}_startAutoScroll(){this.autoScroll&&(this.autoScrollTween=new M(0,2,[new z(this,"_autoScrollFactor",0,1,F.cubic.easeInOut)]),this.autoScrollTween.start())}_stopAutoScroll(){this._stopAutoScrollTimeout(),this.autoScrollTween&&this.autoScrollTween.stop(),this._autoScrollFactor=0}tweenTo(t=0,e=0){this.stopTween(),this.tweenPromise=Promise.resolve();let s=this.scroll.x,i=this.scroll.y;if(this.infiniteLoop.x&&this.panelSize.width>0){for(;s-t>this.panelSize.width/2;)s-=this.panelSize.width;for(;s-t<this.panelSize.width/-2;)s+=this.panelSize.width}if(this.infiniteLoop.y&&this.panelSize.height>0){for(;i-e>this.panelSize.height/2;)i-=this.panelSize.height;for(;i-e<this.panelSize.height/-2;)i+=this.panelSize.height}let n=[];return s!=t&&n.push(new z(this.scrollTarget,"x",s,t,F.cubic.easeOut,100)),i!=e&&n.push(new z(this.scrollTarget,"y",i,e,F.cubic.easeOut,100)),n.length>0&&(this.tween=new M(0,.75,n),this.tweenPromise=this.tween.start()),this.tweenPromise}stopTween(){this.tween&&this.tween.stop()}animationFrame(t){super.animationFrame(t);let e=this.windowSize.remScale||1;this.maxScroll.x>0&&(this.scrollTarget.x+=Math.round(e*this.autoScrollSpeed*this._autoScrollFactor*10)/10),this.maxScroll.y>0&&(this.scrollTarget.y+=Math.round(e*this.autoScrollSpeed*this._autoScrollFactor*10)/10);let s=this.scroll.clone();if(!this.isDragging&&!this.ignoreElasticScroll){this.scrollTarget.x=this.scrollTarget.x+this.momentum.x,this.scrollTarget.y=this.scrollTarget.y+this.momentum.y;let t={x:NaN,y:NaN};this.scrollTarget.x<this.minScroll.x&&(t.x=this.minScroll.x),this.scrollTarget.x>this.maxScroll.x&&(t.x=this.maxScroll.x),isNaN(t.x)||(this.scrollTarget.x+=(t.x-this.scrollTarget.x)*this.elasticScrollInertia),this.scrollTarget.y<this.minScroll.y&&(t.y=this.minScroll.y),this.scrollTarget.y>this.maxScroll.y&&(t.y=this.maxScroll.y),isNaN(t.y)||(this.scrollTarget.y+=(t.y-this.scrollTarget.y)*this.elasticScrollInertia),this.momentum.x*=this.momentumFriction,this.momentum.y*=this.momentumFriction;let e=this.size.width*this.elasticScrollElasticity.x,s=this.size.height*this.elasticScrollElasticity.y;this.scrollTarget.x<this.minScroll.x-e&&(this.momentum.x=0,this.scrollTarget.x=this.minScroll.x-e),this.scrollTarget.x>this.maxScroll.x+e&&(this.momentum.x=0,this.scrollTarget.x=this.maxScroll.x+e),this.scrollTarget.y<this.minScroll.y-s&&(this.momentum.y=0,this.scrollTarget.y=this.minScroll.y-s),this.scrollTarget.y>this.maxScroll.y+s&&(this.momentum.y=0,this.scrollTarget.y=this.maxScroll.y+s)}this.speed.x=this.speed.x*this.springiness+(this.scrollTarget.x-this.scroll.x)/this.inertia,this.scroll.x+=this.speed.x,this.speed.y=this.speed.y*this.springiness+(this.scrollTarget.y-this.scroll.y)/this.inertia,this.scroll.y+=this.speed.y,this.scrollDiff=this.scroll.subtract(s),this.maxScrollReached.x.value=this.scroll.x>=this.maxScroll.x,this.maxScrollReached.y.value=this.scroll.y>=this.maxScroll.y;let i=Math.round(10*this.scroll.x)/10,n=Math.round(10*this.scroll.y)/10;if(this.infiniteLoop.y){let t=0-this.loopPoint.y,e=this.panelSize.height-this.size.height+this.loopPoint.y;for(;n<t;)n+=this.panelSize.height;for(;n>e;)n-=this.panelSize.height}this.updateTransform(i,n)}updateTransform(t,e){this.scrollingPanel.style.transform="translate3d("+-t+"px, "+-e+"px, 0)"}windowResize(t){super.windowResize(t),this.updatePanelSize(),this.updateMaxScroll()}updatePanelSize(){this.size.width=this.rectangle.width,this.size.height=this.rectangle.height,this.panelSize.width=this.scrollingPanel.offsetWidth,this.panelSize.height=this.scrollingPanel.offsetHeight}updateMaxScroll(){this.maxScroll.x=Math.max(this.panelSize.width-this.size.width,0),this.maxScroll.y=Math.max(this.panelSize.height-this.size.height,0),this.infiniteLoop.x&&(this.minScroll.x=-1*Number.MAX_VALUE,this.maxScroll.x=Number.MAX_VALUE),this.infiniteLoop.y&&(this.minScroll.y=-1*Number.MAX_VALUE,this.maxScroll.y=Number.MAX_VALUE),this.element.setAttribute("data-scroll-x",this.maxScroll.x>0),this.element.setAttribute("data-scroll-y",this.maxScroll.y>0)}mousedownHandler(t){this.stopTween(),this.removeWheelHandler(),this.momentum.x=this.momentum.y=0,this.scrollTarget.copyFrom(this.scroll),"input"!==t.target.tagName.toLowerCase()&&(this.maxScroll.x<=0&&this.maxScroll.y<=0||(o||t.preventDefault(),this.autoScroll&&this._stopAutoScroll(),this.isDragging=!1,this.scrollStart=this.scroll.clone(),this.touchStart=this.getTouchPoint(t),this.touchPrevious=this.touchStart,window.addEventListener(c.mousemove,this.mousemoveHandler),window.addEventListener(c.mouseup,this.mouseupHandler)))}get isDragging(){return this._isDragging}set isDragging(t){this._isDragging=t,t?this.element.classList.add("drag"):this.element.classList.remove("drag")}static get DRAG_START(){return"dragStart"}static get DRAG_END(){return"dragEnd"}static get WHEEL(){return"wheel"}mousemoveHandler(t){t.preventDefault();let e=this.getTouchPoint(t),s=a.distance(e,this.touchStart);Math.abs(s)>2&&!this.isDragging&&(this.isDragging=!0,this.dispatchEvent(new Event(Pt.DRAG_START))),this.momentum=this.touchPrevious.subtract(e),this.startTouchDiff=this.touchStart.subtract(e),this.scrollTarget=new a(this.scrollStart.x+this.startTouchDiff.x,this.scrollStart.y+this.startTouchDiff.y),this.touchPrevious=e;let i={x:NaN,y:NaN};this.scrollTarget.x<this.minScroll.x&&(i.x=this.minScroll.x),this.scrollTarget.x>this.maxScroll.x&&(i.x=this.maxScroll.x),isNaN(i.x)||(this.scrollTarget.x=i.x+(this.scrollTarget.x-i.x)*this.elasticScrollElasticity.x),this.scrollTarget.y<this.minScroll.y&&(i.y=this.minScroll.y),this.scrollTarget.y>this.maxScroll.y&&(i.y=this.maxScroll.y),isNaN(i.y)||(this.scrollTarget.y=i.y+(this.scrollTarget.y-i.y)*this.elasticScrollElasticity.y)}getMinimumAbsoluteMomentum(t,e){let s=t<0?-1:1;return t=Math.min(Math.abs(t),e)*s}mouseupHandler(t){window.removeEventListener(c.mousemove,this.mousemoveHandler),window.removeEventListener(c.mouseup,this.mouseupHandler),this.wheelEnabled&&this.addWheelHandler(),this.autoScroll&&this._startAutoScrollTimeout(),this.isDragging=!1;let e=this.size.width*this.momentumScaleLimit;this.momentum.x=this.getMinimumAbsoluteMomentum(this.momentum.x,e);let s=this.size.height*this.momentumScaleLimit;this.momentum.y=this.getMinimumAbsoluteMomentum(this.momentum.y,s),this.dispatchEvent(new Event(Pt.DRAG_END))}}class At extends Ct{constructor(t){super(t),this.init()}init(){C().addEventListener(E.TICK,this.clockTick.bind(this)),window.addEventListener("resize",this.resizeHandler.bind(this)),this.resizeHandler()}clockTick(t){let e={time:Math.round(C().time)/1e3};this.animationFrame(e)}resizeHandler(t){let e=this.getRect();e.orientation=e.width>e.height?"landscape":"portrait",e.orientation!=this.windowSize.orientation&&this.orientationChange(e.orientation),this.windowResize(e)}}A("ui-component",Ct),A("ui-button",Mt),A("ui-list",Ht),A("ui-input",class extends Ct{constructor(t){switch(super(t),this.inputHandler=this.inputHandler.bind(this),this.blurHandler=this.blurHandler.bind(this),this.element.type){case"radio":case"checkbox":this.inputtype="change";break;default:this.inputtype="input"}this.element.addEventListener("blur",this.blurHandler)}get inputtype(){return this._inputtype}set inputtype(t="input"){this.element.removeEventListener(this.inputtype,this.inputHandler),this._inputtype=t,this.element.addEventListener(this.inputtype,this.inputHandler)}get value(){return this.element.value}set value(t){this.element.value=t,this.debug&&console.log("UIInput.value",value)}get model(){return super.model}set model(t){switch(this.debug&&console.log("UIInput.model",t,"value",this.element.value),this.element.type){case"checkbox":this.element.checked=t;break;case"radio":let e=t==this.element.value;e!=this.element.checked&&(this.element.checked=e);break;default:this.element.value=t}super.model=t}inputHandler(t){let e;switch(this.element.type){case"checkbox":e=this.element.checked;break;case"radio":e=this.element.value,console.log("this.element.checked",this.element.checked);default:e=this.element.value}super.model=e}blurHandler(){if(!this.element.value){let t=this.element.getAttribute("placeholder");t&&(this.model=t)}}destroy(){return this.element.removeEventListener("blur",this.blurHandler),this.element.removeEventListener(this.inputtype,this.inputHandler),super.destroy()}}),A("ui-select",class extends Tt{constructor(t){super(t),this._value=this.element.value,this.template='<option is="ui-text" value="{this.scope.data}">{this.scope.data}</option>',this.inputHandler=this.inputHandler.bind(this),this.element.addEventListener("input",this.inputHandler)}get provider(){return super.provider}set provider(t){let e=this.value;super.provider=t,this.value=e}get value(){return this._value}set value(t){this._value!=t&&(this._value=t,p.dispatch(this,"value",t)),this.element.value=t}_providerAdd(t){let e=this.value,s=super._providerAdd(t);return this.value=e,s}_providerRemove(t){let e=this.value,s=super._providerRemove(t);return this.value=e,s}inputHandler(t){this._value=this.element.value,p.dispatch(this,"value",this._value)}destroy(){this.element.removeEventListener("input",this.inputHandler),super.destroy()}}),A("ui-text",Lt),A("ui-html",class extends Lt{get model(){return this.element.innerHTML}set model(t){this.element.innerHTML=t}}),A("ui-number",class extends Lt{constructor(t){super(t),this._currentValue=0,this.isRank=!1,this.roundDecimal=1,this.applyFormat=!1,this.easing=F.cubic.easeOut,this.updateDelay=0,this.updateDuration=0}get model(){return super.model}set model(t){t instanceof Data&&(t=t.value),isNaN(t)&&(t=0),this.updateDuration>0?(this.updateTween&&this.updateTween.stop(),this.updateTween=new M(this.updateDelay,this.updateDuration,[new z(this,"currentValue",this.currentValue,t,this.easing)]),this.updateTween.start()):super.model=t}get currentValue(){return this._currentValue}set currentValue(t){this._currentValue=t;let e=Object(n.i)(t,this.roundDecimal);this.updateCurrentValue(e)}updateCurrentValue(t){if(this.applyFormat){let e=t.toString().split(".");e.length>0&&(e[0]=Object(n.b)(e[0],","),t=e.length>0?e.join("."):e[0])}this.isRank&&(t+=Object(n.c)(t)),super.model=t}}),A("ui-scroll-pane",Pt),A("ui-media",class extends Ct{constructor(t){super(t)}get model(){return this.element.src}set model(t){t instanceof Data&&(t=t.value),bt(t)?this.element.src=t:this.element.removeAttribute("src")}reload(){let t=this.element.src;this.element.src=t}}),A("ui-toggle",class extends Mt{clickDelayComplete(){return this.model.value=!this.model.value,super.clickDelayComplete(event)}});A("easing-graph-control-points",class extends Ht{constructor(t){super(t),this.dragElementClass="shape"}_dragElementStart(){super._dragElementStart(),Gt.model.actions.selectedItem.value.resetEasing()}_dragElementMove(t){t.preventDefault();let e=this.getTouchPoint(t).subtract(this.dragStartPoint).add(this.dragElementStartPos).clone();e.x=e.x/this.rectangle.width,e.y=1-e.y/this.rectangle.height,this.dragElement.component.model.x.value=e.x,this.dragElement.component.model.y.value=e.y}}),A("control-point-lines",class extends Tt{constructor(t){super(t),this.updateLines=this.updateLines.bind(this)}get provider(){return super.provider}set provider(t){super.provider=t;for(let e in t){let s=t[e];for(let t in s){s[t].addEventListener(m.CHANGE,this.updateLines)}}}windowResize(t){super.windowResize(t),this.updateLines()}updateLines(){this.children.map(t=>{t.component.updateLine()})}}),A("control-point-line",class extends Ct{constructor(t){super(t),this.updateLine=this.updateLine.bind(this)}updateLine(){if(!this.model)return;let t=this.element.parentNode.component.rectangle,e=this.model[0].point;e.y=1-e.y;let s=this.model[1].point;s.y=1-s.y;let i=a.distance(e,s),r=Object(n.g)(180*a.getAngle(s,e)/Math.PI),h=new a(e.x*t.width,e.y*t.height),o=`translateX(${h.x}px) translateY(${h.y}px) rotate(${r}deg) scaleX(${i})`;this.element.style.transform=o}}),A("easing-graph-curve",class extends Ct{constructor(t){super(t)}get model(){return this._model}set model(t){this._model=t;let e=[],s="";for(let i=0;i<15;i++){let r=i/14,h=new a(r,t.easing.ease(r,0,1,1));e.push(h),s+=Object(n.h)(200*h.x)+","+Object(n.h)(200-200*h.y)+" "}this.element.setAttribute("points",s)}}),A("easing-graph-points",class extends Ct{constructor(t){super(t)}get model(){return super.model}set model(t){super.model=t,this.element.innerHTML="";let e=[];for(let s=0;s<15;s++){let i=s/14,n=new a(i,t.easing.ease(i,0,1,1));e.push(n)}for(let t=0;t<e.length;t++){let s=e[t],i=N("<point></point>");i.style.left=100*s.x+"%",i.style.top=100-100*s.y+"%",this.element.appendChild(i)}}});A("easing-graph",class extends Ct{constructor(t){super(t)}});A("action-tween",class extends Ct{constructor(t){super(t)}get scope(){return this._scope}set scope(t){super.scope=t,this.easing=N('<div class="sc-fields-list" is="ui-component">\n    <div class="sc-field">\n        <span class="sc-input" title="Duration">\n            <span class="sc-icon fas fa-clock"></span>\n            <span class="sc-input-group">\n                <span class="sc-input-unit" is="ui-text" data-unit="s">{this.scope.data.duration.value}</span>\n                <input type="number" step="0.25" min="0" placeholder="0" is="ui-input" bind:model="this.scope.data.duration.value" />\n            </span>\n        </span>\n        <span class="sc-input" title="Delay">\n            <span class="sc-icon fa fa-hourglass-half"></span>\n            <span class="sc-input-group">\n                <span class="sc-input-unit" is="ui-text" data-unit="s">{this.scope.data.delay.value}</span>\n                <input type="number" step="0.25" min="0" placeholder="0" is="ui-input" bind:model="this.scope.data.delay.value" />\n            </span>\n        </span>\n    </div>\n    <div class="sc-field-group" is="ui-component">\n        <div class="sc-field-column">\n            <div class="sc-field">\n                <div class="sc-input" title="Easing">\n                    <span class="sc-icon fa fa-bezier-curve"></span>\n                    <select is="ui-select" set:provider="this.scope.data.easingPresets" bind:value="this.scope.data.easingPresets.selectedItem.value"></select>\n                </div>\n            </div>\n            <div class="sc-field">\n                <span class="sc-input" title="Bezier point1.x">\n                    <span class="sc-icon">X</span>\n                    <input type="number" step="0.01" placeholder="0" is="ui-input" bind:model="this.scope.data.cubicBezierPoints.p1.x.value" />\n                </span>\n                <span class="sc-input" title="Bezier point1.y">\n                    <span class="sc-icon">Y</span>\n                    <input type="number" step="0.01" placeholder="0" is="ui-input" bind:model="this.scope.data.cubicBezierPoints.p1.y.value" />\n                </span>\n            </div>\n            <div class="sc-field" title="Point2.y">\n                <span class="sc-input" title="Bezier point2.x">\n                    <span class="sc-icon">X</span>\n                    <input type="number" step="0.01" placeholder="0" is="ui-input" bind:model="this.scope.data.cubicBezierPoints.p2.x.value" />\n                </span>\n                <span class="sc-input" title="Bezier point2.y">\n                    <span class="sc-icon">Y</span>\n                    <input type="number" step="0.01" placeholder="0" is="ui-input" bind:model="this.scope.data.cubicBezierPoints.p2.y.value" />\n                </span>\n            </div>\n        </div>\n        <div class="sc-field" is="ui-component">\n            <div is="ui-component" class="easing-graph-container">\n                <div is="easing-graph">\n                    \x3c!-- <svg class="curve" x="0px" y="0px" preserveAspectRatio="none" viewBox="0 0 200 200">\n                        <g>\n                            <polyline class="js" is="easing-graph-curve" set:model="this.scope.data.cubicBezierPoints.debugEasing" points=""></polyline>\n                        </g>\n                    </svg>\n                    <div class="points js" is="easing-graph-points" set:model="this.scope.data.cubicBezierPoints.debugEasing"></div> --\x3e\n                    <svg class="curve" x="0px" y="0px" preserveAspectRatio="none" viewBox="0 0 200 200">\n                        <g>\n                            <polyline is="easing-graph-curve" set:model="this.scope.data.cubicBezierPoints.value" points=""></polyline>\n                        </g>\n                    </svg>\n                    <div class="points" is="easing-graph-points" set:model="this.scope.data.cubicBezierPoints.value"></div>\n                    <div is="control-point-lines" is="ui-list" set:provider="this.scope.data.cubicBezierPoints.controlPointsLines">\n                        <template>\n                            <div is="control-point-line" set:model="this.scope.data"></div>\n                        </template>\n                    </div>\n                    <div class="control-points" is="easing-graph-control-points" set:provider="this.scope.data.cubicBezierPoints.controlPoints">\n                        <template>\n                            <div class="control-point" is="ui-component" set:model="this.scope.data" style="left:calc({this.scope.data.x.value} * 100%); top:calc(100% - {this.scope.data.y.value} * 100%)">\n                                <span class="shape">\n                                    <span class="shape-label" is="ui-text">{this.scope.index + 1}</span>\n                                </span>\n                            </div>\n                        </template>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n',t),this.appendChild(this.easing)}});A("sc-action-view",class extends Ct{constructor(t){super(t)}});class It extends Ct{constructor(t){super(t)}showDelayComplete(){let t=Gt.view.scrollCapture.element.querySelector(".sc-tab[data-id='"+this.slug+"']");t&&t.classList.add("sc-title-tab");let e=super.showDelayComplete();return this.windowResize(this.windowSize),e}hideComplete(){let t=Gt.view.scrollCapture.element.querySelector(".sc-tab[data-id='"+this.slug+"']");return t&&t.classList.remove("sc-title-tab"),super.hideComplete()}}A("sc-scenario",class extends It{constructor(t){super(t)}showDelayComplete(){let t=super.showDelayComplete();if(this.router.redirect("default",()=>this.path),!Gt.model.actions.selectedItem.value){let t=Gt.model.actions.length.value-1;Gt.model.actions.selectedIndex.value=t}return Gt.model.save(),t}hideDelayComplete(){return Gt.model.actions.selectedItem.value=null,super.hideDelayComplete()}}),A("sc-video",class extends It{constructor(t){super(t),this.iframe=this.element.querySelector("iframe"),this.iframe.src=chrome.extension.getURL("video-recording.html"),chrome.runtime.onMessage.addListener((t,e,s)=>{switch(t.txt){case"scrollCaptureVideoHeight":this.iframe.style.height=t.height+"px"}})}showDelayComplete(){let t=super.showDelayComplete();return Gt.model.sendMessage({txt:"scrollCaptureShowVideo"}),t}hideComplete(){return Gt.model.sendMessage({txt:"scrollCaptureUnloadVideo"}),super.hideComplete()}}),A("sc-settings",class extends It{constructor(t){super(t)}showDelayComplete(){let t=super.showDelayComplete();return this.router.redirect("default",()=>this.path),Gt.model.save(),t}});class kt extends Ct{constructor(t){super(t),this.position=null,this.dragStart=this.dragStart.bind(this),this.dragMove=this.dragMove.bind(this),this.dragEnd=this.dragEnd.bind(this),this.element.querySelector(".sc-window.sc-window-main > .sc-title").addEventListener(c.mousedown,this.dragStart),this.windowContent=this.element.querySelector(".sc-window-content[is='sc-window-content-main']").component,this.branches.scenario=this.windowContent.scenario,this.branches.video=this.windowContent.video,this.branches.settings=this.windowContent.settings}dragStart(t){t.preventDefault(),t.target.classList.contains("sc-drag-area")&&(this.startPosition=this.position.serialize(),this.startPoint=this.getTouchPoint(t),document.body.addEventListener(c.mousemove,this.dragMove),document.body.addEventListener(c.mouseup,this.dragEnd))}dragMove(t){let e=this.getTouchPoint(t),s=this.startPoint.subtract(e);this.position.x.value=this.startPosition.x+s.x,this.position.y.value=this.startPosition.y-s.y}dragEnd(t){document.body.removeEventListener(c.mousemove,this.dragMove),document.body.removeEventListener(c.mouseup,this.dragEnd),Gt.model.save()}}function Nt(t,e,s){const i=function(t,e="GET",s=null,i=null,n=null,a=!1,r=15e3,h=5){const o=new Promise((function(l,c){let u,d=0;const p=()=>{u=new XMLHttpRequest,n&&(u.responseType=n),u.onload=t=>{o.progress=1,200===u.status?l(u):c(t)},u.onprogress=t=>{t.lengthComputable&&(o.progress=t.loaded/t.total)},u.onerror=t=>{o.progress=1,c(t)},u.onreadystatechange=t=>{};let m=t;if(a){const t=Math.round(1e9*Math.random());-1===m.indexOf("?")?m+="?":m+="&",m+="nocache="+t.toString()}if(u.open(e,m,!0),u.ontimeout=t=>{d++,d>h?(o.progress=1,c(t)):p()},u.timeout=r,i)for(let t=0;t<i.length;t++){const e=i[t];u.setRequestHeader(e[0],e[1])}s?u.send(s):u.send()};p()}));return o.progress=0,o}(t,"GET",null,null,null,s),n=i.then((function(t){const e=document.createElement("style");return e.type="text/css",e.styleSheet?e.styleSheet.cssText=t.response:e.appendChild(document.createTextNode(t.response)),document.querySelector("head").appendChild(e),e}));return Object.defineProperty(n,"progress",{get:function(){return i.progress}}),n}kt.template='<div class="sc-default" is="scroll-capture" data-theme-light="{this.scope.settings.isColorThemeLight.value}" set:position="this.scope.settings.position" style="right:{this.scope.settings.position.x.value}px; top:{this.scope.settings.position.y.value}px;">\n\t\x3c!-- <ul is="ui-list" set:provider="this.scope.actions">\n\t\t<template>\n\t\t\t<label>\n\t\t\t\t<input class="test-radio" type="radio" is="ui-input" value="{this.scope.data.name.value}" name="options1" bind:model="this.scope.rootScope.selectedAction" />\n\t\t\t\t<span is="ui-text">{this.scope.data.name.value}</span>\n\t\t\t</label>\n\t\t</template>\n\t</ul>\n\t<ul is="ui-list" set:provider="this.scope.actions">\n\t\t<template>\n\t\t\t<label>\n\t\t\t\t<input class="test-radio" type="radio" is="ui-component" value="{this.scope.data.name.value}" name="options2" set:checked="(this.scope.rootScope.selectedAction == this.element.value);" on:change="this.scope.rootScope.selectedAction = this.element.value" />\n\t\t\t\t<span is="ui-text">{this.scope.data.name.value}</span>\n\t\t\t</label>\n\t\t</template>\n\t</ul>\n\t<select is="ui-select" set:provider="this.scope.actions" bind:value="this.scope.selectedAction">\n\t\t<template>\n\t\t\t<option is="ui-text" value="{this.scope.data.name.value}">{this.scope.data.name.value}</option>\n\t\t</template>\n\t</select> --\x3e\n\t<div class="sc-window sc-window-main" is="ui-component">\n\t\t<div class="sc-title">\n\t\t\t<span class="sc-tabs">\n\t\t\t\t<span class="sc-drag-area"></span>\n\t\t\t\t<span class="sc-tab sc-title-tab">\n\t\t\t\t\t<span class="sc-drag-area"></span>\n\t\t\t\t\t<span class="sc-label">Scroll Capture</span>\n\t\t\t\t</span>\n\t\t\t</span>\n\t\t\t<span class="sc-tabs">\n\t\t\t\t<span class="sc-tab">\n\t\t\t\t\t<span class="sc-drag-area"></span>\n\t\t\t\t\t<button is="router-button" data-path="closed" title="Close">\n\t\t\t\t\t\t<span class="sc-icon fas fa-times-circle"></span>\n\t\t\t\t\t</button>\n\t\t\t\t</span>\n\t\t\t</span>\n\t\t</div>\n\t\t<div class="sc-window-content" is="ui-component">\n\t\t\t<div class="sc-fields" is="ui-component">\n\t\t\t\t<div is="ui-component">\n\t\t\t\t\t<div class="sc-window sc-window-sections" is="ui-component">\n\t\t\t\t\t\t<div class="sc-title">\n\t\t\t\t\t\t\t<span class="sc-tabs">\n\t\t\t\t\t\t\t\t<span class="sc-tab" data-id="scenario">\n\t\t\t\t\t\t\t\t\t<button is="router-button" data-path="scroll-capture/scenario" title="Timeline">\n\t\t\t\t\t\t\t\t\t\t\x3c!-- <span class="sc-icon fas fa-sliders-h"></span> --\x3e\n\t\t\t\t\t\t\t\t\t\t<span class="sc-icon fas fa-stream"></span>\n\t\t\t\t\t\t\t\t\t\t<span class="sc-label">Timeline</span>\n\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\x3c!-- <span class="sc-tab" data-id="play" is="ui-component">\n\t\t\t\t\t\t\t\t\t<button is="router-button" data-path="play" title="Play">\n\t\t\t\t\t\t\t\t\t\t<span class="sc-icon fas fa-play"></span>\n\t\t\t\t\t\t\t\t\t\t<span class="sc-label">Play</span>\n\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t</span> --\x3e\n\t\t\t\t\t\t\t\t<span class="sc-tab" data-id="video" is="ui-component">\n\t\t\t\t\t\t\t\t\t<button is="router-button" data-path="record" title="Capture">\n\t\t\t\t\t\t\t\t\t\t<span class="sc-icon fas fa-video"></span>\n\t\t\t\t\t\t\t\t\t\t<span class="sc-label">Capture</span>\n\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t<span class="sc-tabs" is="ui-component">\n\t\t\t\t\t\t\t\t<span class="sc-tab" data-id="settings">\n\t\t\t\t\t\t\t\t\t<button is="router-button" data-path="scroll-capture/settings" title="Settings">\n\t\t\t\t\t\t\t\t\t\t<span class="sc-icon fas fa-cogs"></span>\n\t\t\t\t\t\t\t\t\t\t\x3c!-- <span class="sc-label">Settings</span> --\x3e\n\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="sc-window-content" is="sc-window-content-main" is="ui-component">\n\n\t\t\t\t\t\t\t<div class="sc-section sc-fields" is="sc-scenario">\n\t\t\t\t\t\t\t\t<div is="sc-actions-view" data-actions-length="{this.scope.actions.length.value}" set:provider="this.scope.actions">\n\t\t\t\t\t\t\t\t\t<template>\n\t\t\t\t\t\t\t\t\t\t<div class="sc-window ui-list-element" is="sc-action-view" data-type="{this.scope.data.type}" set:model="this.scope.data" data-selected="{this.scope.data.isSelectedItem.value}">\n\t\t\t\t\t\t\t\t\t\t\t<div class="sc-title">\n\t\t\t\t\t\t\t\t\t\t\t\t<span class="sc-tabs">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div class="sc-drag-area ui-list-drag-area"></div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span class="sc-tab sc-title-tab">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class="ui-list-drag-area"></div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class="sc-tab-wrapper">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class="sc-icon {this.scope.data.icon.value}" is="ui-component"></span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class="sc-label">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<input size="{this.scope.data.name.length.value}" is="ui-input" bind:model="this.scope.data.name.value" />\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\t<span class="sc-tabs">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span class="sc-tab" data-visible="{this.scope.data.isCaptureable.value}" is="ui-component">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class="ui-list-drag-area"></div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<button class="sc-set-button" is="ui-button" data-is-capturing="{this.scope.data.isCapturing.value}" set:model="this.scope.data" on:click="this.model.reCapture()" title="Set">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class="sc-icon fas fa-bullseye"></span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span class="sc-tab" data-visible="{this.scope.data.isTestable.value}" is="ui-component">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class="ui-list-drag-area"></div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<button class="sc-test-button" is="ui-button" set:model="this.scope.data" on:click="this.model.play()" data-is-playing="{this.scope.data.isPlaying.value}" title="Play">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class="sc-icon fas fa-play-circle"></span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span class="sc-tab">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class="ui-list-drag-area"></div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<button class="sc-trash-button" is="ui-button" set:model="this.scope.data" on:click="this.scope.rootScope.actions.removeAction(this.model);" title="Delete">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class="sc-icon fas fa-trash-alt"></span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t<div class="sc-window-content" is="ui-component">\n\t\t\t\t\t\t\t\t\t\t\t\t<div class="sc-fields" is="ui-component">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div class="sc-action-fields" is="ui-list" set:provider="this.scope.data.array">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<template data-type="ActionScroll">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class="sc-action sc-fields-list" is="action-tween">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class="sc-field">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class="sc-input" title="ScrollLeft">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class="sc-icon">X</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class="sc-input-group">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class="sc-input-unit" is="ui-text" data-unit="px">{this.scope.data.unitX.value}</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<input type="number" placeholder="0" min="0" is="ui-input" bind:model="this.scope.data.unitX.value" on:focus="this.scope.data.doScroll()" />\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class="sc-input" title="ScrollTop">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class="sc-icon">Y</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class="sc-input-group">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class="sc-input-unit" is="ui-text" data-unit="px">{this.scope.data.unitY.value}</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<input type="number" placeholder="0" min="0" is="ui-input" bind:model="this.scope.data.unitY.value" on:focus="this.scope.data.doScroll()" />\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class="sc-field">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class="sc-input" title="Target Selector">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class="sc-icon far fa-dot-circle"></span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<input type="text" placeholder="window" is="ui-input" bind:model="this.scope.data.target.value" />\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<template data-type="ActionSwipe">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class="sc-action sc-fields-list" is="action-tween">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class="sc-points-list sc-field-column" is="ui-list" set:provider="this.scope.data.points">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<template>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class="sc-field">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class="sc-input" title="PageX">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class="sc-icon">X</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class="sc-input-group">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class="sc-input-unit" is="ui-text" data-unit="px">{this.scope.data.x.value}</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<input type="number" min="0" placeholder="0" step="1" is="ui-input" bind:model="this.scope.data.x.value" />\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class="sc-input" title="PageY">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class="sc-icon">Y</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class="sc-input-group">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class="sc-input-unit" is="ui-text" data-unit="px">{this.scope.data.y.value}</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<input type="number" min="0" placeholder="0" step="1" is="ui-input" bind:model="this.scope.data.y.value" />\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<template data-type="ActionMouseEvent">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class="sc-action sc-fields-list">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class="sc-field">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class="sc-input">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class="sc-icon">X</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class="sc-input-group">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class="sc-input-unit" is="ui-text" data-unit="px">{this.scope.data.x.value}</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<input type="number" step="1" min="0" placeholder="0" title="PageX" is="ui-input" bind:model="this.scope.data.x.value" />\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class="sc-input">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class="sc-icon">Y</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class="sc-input-group">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class="sc-input-unit" is="ui-text" data-unit="px">{this.scope.data.y.value}</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<input type="number" step="1" min="0" placeholder="0" title="PageY" is="ui-input" bind:model="this.scope.data.y.value" />\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class="sc-field">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class="sc-input sc-select" title="MouseEvent Type">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class="sc-icon fas fa-mouse-pointer"></span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<select is="ui-select" set:provider="this.scope.data.eventTypes" bind:value="this.scope.data.eventTypes.selectedItem.value"></select>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class="sc-input" title="Delay">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class="sc-icon fas fa-hourglass-half"></span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class="sc-input-group">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class="sc-input-unit" is="ui-text" data-unit="s">{this.scope.data.delay.value}</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<input type="number" step="0.25" min="0" placeholder="0" is="ui-input" bind:model="this.scope.data.delay.value" />\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<template data-type="ActionWait">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class="sc-action sc-fields-list">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class="sc-field">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class="sc-input" title="Duration">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class="sc-icon fas fa-clock"></span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class="sc-input-group">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class="sc-input-unit" is="ui-text" data-unit="s">{this.scope.data.delay.value}</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<input type="number" step="0.25" min="0" placeholder="0" is="ui-input" bind:model="this.scope.data.delay.value" />\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class="sc-space"></span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<template data-type="ActionEval">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class="sc-action sc-fields-list">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class="sc-field">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<textarea rows="5" is="ui-input" set:model="this.scope.data.code"></textarea>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class="sc-field">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class="sc-input" title="Delay">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class="sc-icon fas fa-hourglass-half"></span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class="sc-input-group">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class="sc-input-unit" is="ui-text" data-unit="s">{this.scope.data.delay.value}</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<input type="number" step="0.25" min="0" placeholder="0" is="ui-input" bind:model="this.scope.data.delay.value" />\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class="sc-space"></span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class="sc-action-buttons">\n\t\t\t\t\t\t\t\t\t<div class="sc-buttons" is="ui-list" set:provider="this.scope.actions.types">\n\t\t\t\t\t\t\t\t\t\t<template>\n\t\t\t\t\t\t\t\t\t\t\t<button class="sc-action-button" data-type="{this.scope.data.type}" set:model="this.scope.data" is="ui-button" title="{this.scope.data.description.value}" on:click="this.scope.rootScope.actions.cloneAction(this.model);">\n\t\t\t\t\t\t\t\t\t\t\t\t<span class="sc-icon {this.scope.data.icon.value}" is="ui-component"></span>\n\t\t\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div class="sc-buttons">\n\t\t\t\t\t\t\t\t\t\t<button is="ui-button" on:click="this.scope.clearActions()" title="Delete all">\n\t\t\t\t\t\t\t\t\t\t\t<span class="sc-icon fas fa-trash-alt"></span>\n\t\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t<div class="sc-section sc-fields" is="sc-video">\n\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t<iframe></iframe>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t<div class="sc-section sc-fields" is="sc-settings">\n\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t<div class="sc-window">\n\t\t\t\t\t\t\t\t\t\t<div class="sc-title">\n\t\t\t\t\t\t\t\t\t\t\t<span class="sc-tabs">\n\t\t\t\t\t\t\t\t\t\t\t\t<span class="sc-tab sc-title-tab">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span class="sc-icon fas fa-adjust"></span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span class="sc-label">Color theme</span>\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t<span class="sc-tabs"></span>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<div class="sc-window-content" is="ui-component">\n\t\t\t\t\t\t\t\t\t\t\t<div class="sc-fields" is="ui-component">\n\t\t\t\t\t\t\t\t\t\t\t\t<div class="sc-field">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\x3c!-- <span class="sc-label">Theme:</span> --\x3e\n\t\t\t\t\t\t\t\t\t\t\t\t\t\x3c!-- <div class="sc-color-themes" is="ui-list" set:provider="this.scope.settings.colorThemes">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<template>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<label class="sc-radio">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<input type="radio" name="color-theme" value="{this.scope.data}" is="ui-input" set:model="this.scope.parentScope.settings.colorThemes.selectedItem" />\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class="sc-icon fas fa-check"></span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span is="ui-text">{this.scope.data}</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div> --\x3e\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div class="sc-input sc-select">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class="sc-icon fas" data-theme="{this.scope.settings.colorThemes.selectedItem.value}" is="ui-component"></span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<select is="ui-select" set:provider="this.scope.settings.colorThemes" bind:value="this.scope.settings.colorThemes.selectedItem.value"></select>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div class="sc-space"></div>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t<div class="sc-window">\n\t\t\t\t\t\t\t\t\t\t<div class="sc-title">\n\t\t\t\t\t\t\t\t\t\t\t<span class="sc-tabs">\n\t\t\t\t\t\t\t\t\t\t\t\t<span class="sc-tab sc-title-tab">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span class="sc-icon far fa-window-maximize"></span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span class="sc-label">Window size</span>\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t<span class="sc-tabs"></span>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<div class="sc-window-content" is="ui-component">\n\t\t\t\t\t\t\t\t\t\t\t<div class="sc-fields" is="ui-component">\n\t\t\t\t\t\t\t\t\t\t\t\t<div class="sc-field">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span class="sc-input">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class="sc-icon">W</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class="sc-input-group">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class="sc-input-unit" is="ui-text" data-unit="px">{this.scope.settings.windowSize.x.value}</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<input type="number" step="1" min="375" placeholder="375" title="PageX" is="ui-input" bind:model="this.scope.settings.windowSize.x.value" />\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span class="sc-input">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class="sc-icon">H</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class="sc-input-group">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class="sc-input-unit" is="ui-text" data-unit="px">{this.scope.settings.windowSize.y.value}</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<input type="number" step="1" min="375" placeholder="375" title="PageY" is="ui-input" bind:model="this.scope.settings.windowSize.y.value" />\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t<div class="sc-window">\n\t\t\t\t\t\t\t\t\t\t<div class="sc-title">\n\t\t\t\t\t\t\t\t\t\t\t<span class="sc-tabs">\n\t\t\t\t\t\t\t\t\t\t\t\t<span class="sc-tab sc-title-tab">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span class="sc-icon fas fa-film"></span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span class="sc-label">Codecs</span>\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t<span class="sc-tabs"></span>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<div class="sc-window-content" is="ui-component">\n\t\t\t\t\t\t\t\t\t\t\t<div class="sc-fields" is="ui-component">\n\t\t\t\t\t\t\t\t\t\t\t\t<div class="sc-field-group">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div class="sc-field">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class="sc-input sc-select">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class="sc-icon fas fa-video"></span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<select is="ui-select" set:provider="this.scope.settings.videoCodecs" bind:value="this.scope.settings.videoCodecs.selectedItem.value"></select>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div class="sc-field">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<input type="range" min="1" max="8" step="1" title="Bitrate" is="ui-input" bind:model="this.scope.settings.videoBitsPerSecond.value" />\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class="sc-space">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class="sc-input-unit" is="ui-text" data-unit="Mbps">{this.scope.settings.videoBitsPerSecond.value}</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span is="ui-text">{this.scope.settings.videoBitsPerSecond.value}</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t<div class="sc-field-group">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div class="sc-field">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class="sc-input sc-select">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class="sc-icon fas fa-volume-up"></span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<select is="ui-select" set:provider="this.scope.settings.audioCodecs" bind:value="this.scope.settings.audioCodecs.selectedItem.value"></select>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div class="sc-field">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<input type="range" min="16" max="128" step="16" is="ui-input" bind:model="this.scope.settings.audioBitsPerSecond.value" />\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class="sc-space">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class="sc-input-unit" is="ui-text" data-unit="kbps">{this.scope.settings.audioBitsPerSecond.value}</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span is="ui-text">{this.scope.settings.audioBitsPerSecond.value}</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div>\n\t\t\t\t\t<sc-credits><a href="http://www.patrickmatte.com" target="_blank"></a></sc-credits>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>',A("sc-actions-view",class extends Ht{constructor(t){super(t),this.selectItemOnMouseDown=!0}_providerAdd(t){let e=super._providerAdd(t),s=this.getElementByModel(e[0]);return this.scrollToElement(s,.5),e}_dragEnd(t){let e=this.isDragged,s=super._dragEnd(t);return e&&Gt.model.save(),s}}),A("sc-window-content-main",class extends Ct{constructor(t){super(t),this.scenario=this.element.querySelector("[is='sc-scenario']").component,this.video=this.element.querySelector("[is='sc-video']").component,this.settings=this.element.querySelector("[is='sc-settings']").component}});class Dt extends Mt{constructor(t){super(t),this.pushState=!0}clickHandler(t){t.preventDefault(),super.clickHandler(t)}clickDelayComplete(t){super.clickDelayComplete(t);let e=this.element.href;if(e){let t=e.substr(this.router.absoluteBasePath.length);this.pushState&&this.router.pushState(t)}else this.router.location=this.element.getAttribute("data-path")}}class Ot extends At{constructor(t){super(document.body),this.scope=Gt.model,this.scrollCapture=N(kt.template,Gt.model).component,this.appendChild(this.scrollCapture.element),Gt.model.showCaptureIcon.addEventListener(m.CHANGE,t=>{this.element.setAttribute("is-capturing",t.data)})}load(){let t=Nt(chrome.extension.getURL("content.css")),e=Nt(chrome.extension.getURL("fontawesome.css"));return Promise.all([t,e])}}A("router-button",class extends Dt{get router(){return Gt.controller.router}}),A("scroll-capture",kt);class Rt{constructor(t=[]){this.assets=t}get progress(){let t=0,e=this.assets.length;for(let s=0;s<this.assets.length;s++){const i=this.assets[s];i.hasOwnProperty("progress")?t+=i.progress:e--}return e>0?t/=e:t=1,t}push(t){return this.assets.push(t),t}}class Bt{constructor(t,e){this.name=t,this.preload=e,this.branches=[],this.router=null,this.checkProgressBind=this.checkProgress.bind(this)}start(){if(this.preloader=null,this.assets=[],this.branches.length>0)if(this.preload){for(let t=0;t<this.branches.length;t++)this.assets.push(new Rt);if(this.assetList=new Rt(this.assets.slice()),this.preloader=this.router.preloader,this.preloader){this.isPreloading=!0,this.checkProgress();const t=this.preloader.show();t?t.then(t=>{this.startNextBranch()}):this.startNextBranch()}else this.startNextBranch()}else this.startNextBranch();else this.allComplete()}checkProgress(){this.assetList&&(this.preloader.progress=this.assetList.progress),this.isPreloading&&(this.animationFrame=requestAnimationFrame(this.checkProgressBind))}startNextBranch(){this.branch=this.branches.shift();let t=this.branch[this.name];if(t){t=t.bind(this.branch);const e=this.assets.shift(),s=t(this.branch,e);s?s.then(this.branchComplete.bind(this)):this.branchComplete()}else this.branchComplete()}branchComplete(){if(this.branches.length>0)this.startNextBranch();else if(this.preloader){this.isPreloading=!1;const t=this.preloader.hide();t?t.then(this.allComplete.bind(this)):this.allComplete()}else this.allComplete()}allComplete(){this.assets=null,this.assetList=null,this.branches=null,window.requestAnimationFrame(()=>{this.onComplete()})}}class Ft{constructor(t,e,s){this.router=t,this.name=e,this.onComplete=s,this.branches=[],this.tasks=[]}start(){if(this.branches.length>0){let t;for(let e=this.tasks.length-1;e>-1;e--){const s=this.tasks[e];s.router=this.router,s.branches=this.branches.slice(),s.onComplete=t?t.start.bind(t):this.tasksComplete.bind(this),t=s}this.tasks[0].start()}else this.tasksComplete()}tasksComplete(){this.onComplete()}}class Xt extends EventTarget{constructor(t){super(),this.root=t,this._location=null,this.goToAllLocations=!1,this.interruptTransitions=!0,this._inTransition=!1,this._interruptingLocations=[],this.branches=new w,this.redirects={},this.parameters={},this.show=new Ft(this,"show",this._showComplete.bind(this)),this.show.tasks=[new Bt("load",!0),new Bt("show",!1)],this.hide=new Ft(this,"hide",this._hideComplete.bind(this)),this.hide.tasks=[new Bt("hide",!1)]}static get INTERRUPT(){return"interrupt"}static get CHANGE(){return"change"}static get COMPLETE(){return"complete"}get root(){return this._root}set root(t){this._root=t}get location(){return this._location}set location(t){if(this.debug&&console.log("Router set location",t),-1!==t.indexOf("?")&&(t=t.split("?")[0]),this._inTransition)if(this.goToAllLocations){this._interruptingLocations[this._interruptingLocations.length-1]!==t&&this._interruptingLocations.push(t)}else this._interruptingLocations=[t];else this.changeTheLocation(t)}start(){this.location=""}pushState(t){this.location=t}changeTheLocation(t){const e=t.split("&");this.parameters={};for(let t=0;t<e.length;t++){const s=e[t],i=s.indexOf("=");if(-1!==i){const t=[];t[0]=s.substr(0,i),t[1]=s.substr(i+1),this.parameters[t[0]]=t[1]}}let s=e[0],i=s.charAt(s.length-1);for(;"/"===i;)s=s.substr(0,s.length-1),i=s.charAt(s.length-1);if(s=this._applyRedirect(s),s!==this._location){this._inTransition=!0,this._location=s;const t=new d(Xt.CHANGE,{location:s});this.dispatchEvent(t),this._nextLocation="root",""!==s&&(this._nextLocation+="/"+s),setTimeout(()=>{this._startTransitions()},0)}else this._showComplete()}_applyRedirect(t){const e=this.redirects[t];let s;return e&&(s=e()),s=s||t,s!==t&&(s=this._applyRedirect(s)),s}_startTransitions(){const t=this.branches.value.map(t=>t.slug),e=this._nextLocation.split("/");let s=-1;for(let i=0;i<t.length;i++){t.slice(0,i+1).join("/")===e.slice(0,i+1).join("/")&&(s=i)}this.hide.branches=this.branches.splice(s+1).reverse();let i=this;this.branches.length>0&&(i=this.branches.item(this.branches.length-1));const n=[];for(let t=s+1;t<e.length;t++){const s=e[t],a=this.getBranchFromSlug(i,s);n.push(a),i=a}this.checkForDefaultBranches(i,n),this.show.branches=n,this.hide.start()}checkForDefaultBranches(t,e){if(t&&t.defaultChild){const s=t.defaultChild,i=this.getBranchFromSlug(t,s);i&&(e.push(i),this.checkForDefaultBranches(i,e))}}getBranchFromSlug(t,e){let s;if(e){if(!t.getBranch)throw new Error("The branch '"+t.slug+"' doesn't implement the getBranch method for '"+e+"'");s=t.getBranch(e),s.router=this,s.parent=t,s.root=t.root,s.slug=e;let i="";i=t===this?"":"root"===t.slug?e:t.path+"/"+e,s.path=i}return s}_hideComplete(t){let e=!1;if(this.interruptTransitions&&this._interruptingLocations.lenth>0){const t=this._interruptingLocations[0];null===t&&void 0===t||(e=!0)}if(e){this._inTransition=!1;const t=new d(Xt.INTERRUPT,{location:this.location});this.dispatchEvent(t),this.changeTheLocation(this._interruptingLocations.shift())}else this.branches.push.apply(this.branches,this.show.branches),this.show.start()}_showComplete(t){this._inTransition=!1;const e=new d(Xt.COMPLETE,{location:this.location});this.dispatchEvent(e),this._interruptingLocations.length>0&&this.changeTheLocation(this._interruptingLocations.shift())}getBranch(t){return this.root}redirect(t,e){e?this.redirects[t]=e:delete this.redirects[t]}destroy(){this._interruptingLocations=null,this.branches=null,this.redirects=null,this.root=null,this.popStateBind=null}toString(){return"[Router location="+this.location+"]"}}class Vt extends wt{constructor(){super(),this.isPlaying=!1,this.startLocation="scroll-capture/scenario"}show(){return this.isPlaying=!0,this.router.redirect("default",()=>this.startLocation),Gt.model.save(),Gt.model.actions.selectedIndex.value=0,f(.25).then(()=>this.triggerAction())}triggerAction(){if(!this.isPlaying)return;let t=Gt.model.actions.selectedItem.value;if(t){t.triggerDelay().then(()=>this.actionComplete())}else this.allComplete()}actionComplete(){this.isPlaying&&(Gt.model.actions.selectedIndex.value<Gt.model.actions.value.length-1?(Gt.model.actions.selectedIndex.value=Gt.model.actions.selectedIndex.value+1,this.triggerAction()):this.allComplete())}allComplete(){this.isPlaying&&(this.isPlaying=!1,this.router.location=this.startLocation)}hide(){return this.isPlaying=!1,super.hide()}}class Yt extends Vt{constructor(){super(),this.startLocation="scroll-capture/video"}show(){return Object(i.a)("record-actions-length",Gt.model.actions.value.length.toString()),Gt.model.actions.value.length<1&&(this.timeout=new mt,this.timeout.delay.value=300,Gt.model.actions.addAction(this.timeout)),f(.25).then(()=>(Gt.model.sendMessage({txt:"scrollCaptureStartRecording"}),super.show()))}allComplete(){this.isPlaying&&(this.stopTheRecording(),super.allComplete())}stopTheRecording(){Gt.model.sendMessage({txt:"scrollCaptureStopRecording"}),Gt.model.sendMessage({txt:"scrollCaptureUpdateVideo"})}hide(){return window.removeEventListener("onbeforeunload",this.onBeforeUnloadHandler),this.isPlaying&&this.stopTheRecording(),this.timeout&&(Gt.model.actions.removeAction(this.timeout),this.timeout=null),super.hide()}}class qt extends wt{constructor(){super()}show(){return Gt.model.save(),super.show()}}class jt extends wt{constructor(){super(),this.trackRouterLocation=this.trackRouterLocation.bind(this),this.beforeUnloadHandler=this.beforeUnloadHandler.bind(this),this.router=new Xt(this),this.router.redirect("default",()=>"scroll-capture/scenario"),this.router.addEventListener(Xt.CHANGE,this.trackRouterLocation),this.branches={"scroll-capture":Gt.view.scrollCapture,play:new Vt,record:new Yt,closed:new qt},window.addEventListener("beforeunload",this.beforeUnloadHandler)}trackRouterLocation(){Object(i.b)("/"+this.router.location)}beforeUnloadHandler(t){this.router.removeEventListener(Xt.CHANGE,this.trackRouterLocation),this.router.location=""}load(){let t=Gt.view.load(),e=new Promise((t,e)=>{chrome.storage.local.get(["json"],e=>{t(e)})});return Promise.all([e,t]).then(t=>{if(t[0]){let e=t[0].json;if(e){let t=JSON.parse(e);Gt.model.actions.deserialize(t.actions),Gt.model.settings.deserialize(t.settings)}}})}show(){Object(i.a)("ScrollCaptureStart",window.location.origin+window.location.pathname)}hide(){}}let Gt;class Ut{constructor(){Gt=this,this.model=new xt,this.view=new Ot,this.controller=new jt}}window.scrollCaptureApp||(window.scrollCaptureApp=new Ut),Gt=window.scrollCaptureApp,Gt.controller.router.location="default"}]);