(()=>{"use strict";function e(e){return e<10?"0"+e:e.toString()}function t(t){let o=t.getHours(),r=o>=12?"pm":"am";return o%=12,o=o||12,{hours:o,minutes:e(t.getMinutes()),seconds:e(t.getSeconds()),ampm:r}}function o(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";chrome.runtime.sendMessage({type:"scrollCaptureTrackEvent",category:e,action:t,label:o})}chrome.storage.local.get(["json"],(e=>{let t,o="Dark";if(e&&e.json){let t=JSON.parse(e.json);t.settings&&(o=t.settings.colorThemes)}switch(o){case"Dark":case"Light":t="Light"==o;break;default:t=!window.matchMedia("(prefers-color-scheme: dark)").matches}document.body.querySelector(".sc-default").setAttribute("data-theme-light",t)})),window.addEventListener("resize",(()=>{a()})),chrome.runtime.onMessage.addListener(((s,n,l)=>{switch(s.type){case"scrollCaptureColorTheme":document.body.querySelector(".sc-default").setAttribute("data-theme-light",s.isColorThemeLight);break;case"scrollCaptureUnloadVideo":r.pause();break;case"scrollCaptureShowVideo":a();break;case"scrollCaptureVideoURL":!function(a){const s=a.videoURL;let n=a.extension;r.src=s;let l=new Date,c=t(l),i={year:l.getFullYear(),month:e(l.getMonth()+1),date:e(l.getDate())};c.ampm=c.ampm.toUpperCase();let d=`Scroll Capture ${i.year}-${i.month}-${i.date} at ${c.hours}.${c.minutes}.${c.seconds} ${c.ampm}.${n}`,u=document.querySelectorAll("a.sc-download-button");for(let e=0;e<u.length;e++){let t=u[e];t.href=s,t.download=d,t.addEventListener("click",(()=>{o("download","click")}))}document.querySelector(".sc-video-filename a.sc-download-button").textContent=d}(s)}}));let r=document.querySelector(".sc-video-player");function a(){chrome.storage.local.get(["tabId"]).then((e=>{let t={type:"scrollCaptureVideoHeight",height:document.body.scrollHeight};chrome.tabs.sendMessage(e.tabId,t)}))}r.setAttribute("muted","true"),r.setAttribute("autoplay","true"),r.setAttribute("playsinline","true"),r.setAttribute("controls","1"),r.addEventListener("canplay",(()=>{a()}))})();