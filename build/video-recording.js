(()=>{"use strict";function e(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";chrome.runtime.sendMessage({type:"scrollCaptureTrackEvent",category:e,action:t,label:o})}function t(e){return e<10?"0"+e:e.toString()}function o(e){let o=e.getHours(),r=o>=12?"pm":"am";return o%=12,o=o||12,{hours:o,minutes:t(e.getMinutes()),seconds:t(e.getSeconds()),ampm:r}}chrome.storage.local.get(["json"],(e=>{let t,o="Dark";if(e&&e.json){let t=JSON.parse(e.json);t.settings&&(o=t.settings.colorThemes)}switch(o){case"Dark":case"Light":t="Light"==o;break;default:t=!window.matchMedia("(prefers-color-scheme: dark)").matches}document.body.querySelector(".sc-default").setAttribute("data-theme-light",t)})),window.addEventListener("resize",(()=>{s()})),chrome.runtime.onMessage.addListener(((a,n,l)=>{switch(a.type){case"scrollCaptureColorTheme":document.body.querySelector(".sc-default").setAttribute("data-theme-light",a.isColorThemeLight);break;case"scrollCaptureUnloadVideo":r.pause();break;case"scrollCaptureShowVideo":s();break;case"scrollCaptureVideoURL":!function(s){const a=s.videoURL;r.src=a;let n=function(e){console.log("createFilename",e);let r=new Date,s=o(r),a=r.getFullYear(),n=t(r.getMonth()+1),l=t(r.getDate());return s.ampm=s.ampm.toUpperCase(),`Scroll Capture ${a}-${n}-${l} at ${s.hours}.${s.minutes}.${s.seconds} ${s.ampm}.${e}`}(s.extension),l=document.querySelectorAll("a.sc-download-button");for(let t=0;t<l.length;t++){let o=l[t];o.href=a,o.download=n,o.addEventListener("click",(()=>{e("download","click")}))}document.querySelector(".sc-video-filename a.sc-download-button").textContent=n}(a)}}));let r=document.querySelector(".sc-video-player");function s(){chrome.storage.local.get(["tabId"]).then((e=>{let t={type:"scrollCaptureVideoHeight",height:document.body.scrollHeight};chrome.tabs.sendMessage(e.tabId,t)}))}r.setAttribute("muted","true"),r.setAttribute("autoplay","true"),r.setAttribute("playsinline","true"),r.setAttribute("controls","1"),r.addEventListener("canplay",(()=>{s()}))})();